<p-toast key="compacct-toast" baseZIndex="99999"></p-toast>
<p-toast position="center" key="c" (onClose)="onReject()" [modal]="true" [autoZIndex]="true">
    <ng-template let-message pTemplate="message">
        <div style="text-align: center">
            <i class="pi pi-exclamation-triangle" style="font-size: 3em"></i>
            <h3>{{message.summary}}</h3>
            <p>{{message.detail}}</p>
        </div>

        <div class="ui-g ui-fluid">
            <div class="ui-g-6">
                <button type="button" pButton (click)="actionClick_UpdateAppo(colobj)" label="Yes" class="ui-button-success"></button>
            </div>
            <div class="ui-g-6">
                <button type="button" pButton (click)="actionClick_UpdateAppoNo(colobj)" label="No" class="ui-button-secondary"></button>
            </div>
        </div>
    </ng-template>
</p-toast>

<div class="row">
    <div class="col-xs-12">
        <div class="box box-primary">
            <div class="form-horizontal">
                <div class="box-body">
                    <p-tabView [activeIndex]="tabIndexToView" (onChange)="TabClick($event)">

                        <p-tabPanel headerStyleClass="compacct-tabs" [header]="items[0]" leftIcon="glyphicon glyphicon-exclamation-sign" >

                            <form name="SearchForm" #SearchForm="ngForm" novalidate>
                                <div class="form-group">
                                    <div class="col-sm-4">
                                        <label class="control-label">Date Range</label>
                                        <app-compacct-daterangepicker (DaterangeObj)="getDateRange($event)">
                                        </app-compacct-daterangepicker>
                                    </div>
                                    <div class="col-sm-4">
                                        <button class="btn btn-primary custombutton" (click)="getAlldata()" [disabled]="seachSpinner">
                                            <p-progressSpinner *ngIf="seachSpinner" [style]="{width: '15px', height: '15px'}" strokeWidth="8"  animationDuration=".5s"></p-progressSpinner>
                                            <span *ngIf="!seachSpinner" class="glyphicon glyphicon-search"></span>&nbsp;Search
                                        </button>
                                    </div>
                                </div>
                            </form>

                            <p-table [value]="allDetalis" [paginator]="allDetalis.length ? true : false"
                                        [rows]="100" [rowHover]="true" [autoLayout]="true" sortMode="multiple"
                                        [rowsPerPageOptions]="[100,200,300]"
                                        [globalFilterFields]="allDetalisHeader" [rowHover]="true" #dt>
                                        <ng-template pTemplate="caption"  >
                                            <div class="row">
                                                <div class="col-sm-3 pull-right" style="text-align: right">
                                                    <input type="text" pInputText size="50" placeholder="Search"
                                                        (input)="dt.filterGlobal($event.target.value, 'contains')"
                                                        class="searchInput form-control">
                                                </div>
                                            </div>
                                        </ng-template>
                                        <ng-template pTemplate="header">
                                            <tr>
                                                <th style="width:5em">Action</th>
                                                <th>Date</th>
                                                <th>Patient Name</th>
                                                <th>Mobile</th>
                                                <th>Age</th>
                                                <th>Sex</th>
                                                <th>CostCentre Name</th>
                                                <th>Consultancy Name</th>
                                            </tr>
                                        </ng-template>
                                        <ng-template pTemplate="body" let-col>
                                            <tr>
                                                <td>
                                                    <div class="dropdown">
                                                        <button
                                                            class="btn btn-default btn-sm tableButton dropdown-toggle"
                                                            type="button" data-toggle="dropdown" style="height:27px">
                                                            <i class="fa fa-fw fa-bars"></i>
                                                            <span class="caret"></span>
                                                        </button>
                                                         <ul class="dropdown-menu">
                                                             <li>
                                                                <a (click)="actionClick_PatientDetails(col)" >
                                                                   <i class="fa fa-fw fa-user"></i>
                                                                   Patient Details
                                                                </a>
                                                            </li>
                                                             <li *ngIf="this.databaseName=='GN_Soft_Hear_UP'">
                                                                <a (click)="viewCaseHistory(col)" >
                                                                   <i class="fa fa-eye"></i>
                                                                   View Case History
                                                                </a>
                                                            </li>
                                                            <li *ngIf="databaseName != 'GN_Crystal_Mumbai'">
                                                                <a (click)="actionClick_UpdateAppo(col)">
                                                                    <i class="fa fa-repeat"></i>
                                                                    Update Appointment
                                                                </a>
                                                            </li>
                                                            <li *ngIf="databaseName === 'GN_Crystal_Mumbai'">
                                                                <a (click)="UpdateAppo(col)">
                                                                    <i class="fa fa-repeat"></i>
                                                                    Update Appointment
                                                                </a>
                                                            </li>
                                                            <li>
                                                                <a (click)="actionClick_Shift(col)">
                                                                    <i class="fa fa-edit"></i>
                                                                    Shift to other Audiologist 
                                                                </a>
                                                            </li>
                                                            <li>
                                                                <a (click)="actionClick_Programming(col)">
                                                                    <i class="fa fa-exchange"></i>
                                                                    Reprogramming & Other HL not known Tests 
                                                                </a>
                                                            </li>
                                                            <li *ngIf="(databaseName === 'GN_Soft_Hear_UP')&&(col.Age>10)">
                                                                <a (click)="AdultSoftHear(col)">
                                                                    <i class="fa fa-wheelchair"></i>
                                                                    Adult Assessment
                                                                </a>
                                                            </li>
                                                            <li *ngIf="(databaseName === 'GN_Soft_Hear_UP')&&(10>col.Age)">
                                                                <a (click)="ChildSoftHear(col)">
                                                                    <i class="fa fa-child"></i>
                                                                    Child Assessment
                                                                </a>
                                                            </li>
                                                         </ul>
                                                    </div>
                                                </td>
                                                <td nowrap>{{col.Appo_Start | date: "dd/MMM/yyyy"}}</td>
                                                <td nowrap>{{col.Patient ? col.Patient : '-'}}</td>
                                                <td nowrap>{{col.Mobile ? col.Mobile : '-'}}</td>
                                                <td nowrap>{{col.Age ? col.Age : '-'}}</td>
                                                <td nowrap>{{col.Sex ? col.Sex : '-'}}</td>
                                                <td nowrap>{{col.Cost_Cen_Name ? col.Cost_Cen_Name : '-'}}</td>
                                                <td nowrap>{{col.Consultancy ? col.Consultancy : '-'}}</td>
                                        </ng-template>
                                        <ng-template pTemplate="paginatorright" let-state>
                                            Showing {{state.first+1}} of {{(state.first+1) + state.rows}} of
                                            {{state.totalRecords}}
                                        </ng-template>
                            </p-table>
                                
                        </p-tabPanel>

                        <p-tabPanel headerStyleClass="compacct-tabs" [header]="items[1]" leftIcon="glyphicon glyphicon-ok">

                            <form name="CompletedSearchForm" #CompletedSearchForm="ngForm" novalidate>
                                <div class="form-group">
                                    <div class="col-sm-4">
                                        <label class="control-label">Date Range</label>
                                        <app-compacct-daterangepicker (DaterangeObj)="getDateRangeComplete($event)">
                                        </app-compacct-daterangepicker>
                                    </div>
                                    <div class="col-sm-4">
                                        <button class="btn btn-primary custombutton" (click)="getAllCompletedData()" [disabled]="CompletedSeachSpinner">
                                            <p-progressSpinner *ngIf="CompletedSeachSpinner" [style]="{width: '15px', height: '15px'}" strokeWidth="8"  animationDuration=".5s"></p-progressSpinner>
                                            <span *ngIf="!CompletedSeachSpinner" class="glyphicon glyphicon-search"></span>&nbsp;Search
                                        </button>
                                    </div>
                                </div>
                            </form>

                            <p-table [value]="CompletedAllDetalis" [paginator]="CompletedAllDetalis.length ? true : false"
                                        [rows]="100" [rowHover]="true" [autoLayout]="true" sortMode="multiple"
                                        [rowsPerPageOptions]="[100,200,300]"
                                        [globalFilterFields]="CompletedAllDetalisHeader" [rowHover]="true" #dt1>
                                        <ng-template pTemplate="caption"  >
                                            <div class="row">
                                                <div class="col-sm-3 pull-right" style="text-align: right">
                                                    <input type="text" pInputText size="50" placeholder="Search"
                                                        (input)="dt1.filterGlobal($event.target.value, 'contains')"
                                                        class="searchInput form-control">
                                                </div>
                                            </div>
                                        </ng-template>
                                        <ng-template pTemplate="header">
                                            <tr>
                                                <th style="width:5em">Action</th>
                                                <th>Date</th>
                                                <th>Patient Name</th>
                                                <th>Mobile</th>
                                                <th>Age</th>
                                                <th>Sex</th>
                                                <th>CostCentre Name</th>
                                                <th>Consultancy Name</th>
                                            </tr>
                                        </ng-template>
                                        <ng-template pTemplate="body" let-col>
                                            <tr>
                                                <td>
                                                    <div class="dropdown">
                                                        <button
                                                            class="btn btn-default btn-sm tableButton dropdown-toggle"
                                                            type="button" data-toggle="dropdown" style="height:27px">
                                                            <i class="fa fa-fw fa-bars"></i>
                                                            <span class="caret"></span>
                                                        </button>
                                                         <ul class="dropdown-menu">
                                                             <li>
                                                                <a (click)="actionClick_PatientDetails(col)" >
                                                                   <i class="fa fa-fw fa-user"></i>
                                                                   Patient Details
                                                                </a>
                                                            </li>
                                                            <li *ngIf="this.databaseName=='GN_Soft_Hear_UP'">
                                                                <a (click)="viewCaseHistory(col)" >
                                                                   <i class="fa fa-eye"></i>
                                                                   View Case History
                                                                </a>
                                                            </li>
                                                            <li *ngIf="col.Appo_Type == 'PTA'">
                                                                <a (click)="actionClick_ViewAppo(col)">
                                                                    <i class="fa fa-eye"></i>
                                                                    View Update Appointment 
                                                                </a>
                                                            </li>
                                                            <li *ngIf="col.Appo_Type == 'Reprogramming'">
                                                                <a (click)="actionClick_ViewProgramming(col)">
                                                                    <i class="fa fa-eye"></i>
                                                                    View Reprogramming & Other HL not known Tests 
                                                                </a>
                                                            </li>
                                                            <li *ngIf="databaseName === 'GN_Crystal_Mumbai'">
                                                                <a (click)="ViewTestDetails(col)">
                                                                    <i class="fa fa-eye"></i>
                                                                    View Test Details 
                                                                </a>
                                                            </li>
                                                            <li *ngIf="(databaseName === 'GN_Soft_Hear_UP')&&(col.Age>10)">
                                                                <a (click)="AdultSoftHear(col)">
                                                                    <i class="fa fa-wheelchair"></i>
                                                                    Adult Assessment
                                                                </a>
                                                            </li>
                                                            <li *ngIf="(databaseName === 'GN_Soft_Hear_UP')&&(10>col.Age)">
                                                                <a (click)="ChildSoftHear(col)">
                                                                    <i class="fa fa-child"></i>
                                                                    Child Assessment
                                                                </a>
                                                            </li>
                                                         </ul>
                                                    </div>
                                                </td>
                                                <td nowrap>{{col.Appo_Start | date: "dd/MMM/yyyy"}}</td>
                                                <td nowrap>{{col.Patient ? col.Patient : '-'}}</td>
                                                <td nowrap>{{col.Mobile ? col.Mobile : '-'}}</td>
                                                <td nowrap>{{col.Age ? col.Age : '-'}}</td>
                                                <td nowrap>{{col.Sex ? col.Sex : '-'}}</td>
                                                <td nowrap>{{col.Cost_Cen_Name ? col.Cost_Cen_Name : '-'}}</td>
                                                <td nowrap>{{col.Consultancy ? col.Consultancy : '-'}}</td>
                                        </ng-template>
                                        <ng-template pTemplate="paginatorright" let-state>
                                            Showing {{state.first+1}} of {{(state.first+1) + state.rows}} of
                                            {{state.totalRecords}}
                                        </ng-template>
                            </p-table>

                        </p-tabPanel>

                    </p-tabView>
                </div>
            </div>
        </div>
    </div>
</div>


<p-dialog
   [header]="'Update Audiologist'"
   [appendTo]="'body'"
   [visible]="displayPopup"
   [closeOnEscape]="true"
   [closable]="false"
   [modal]="true"
   [responsive]="false"
   [style]="{ width: '60%', minWidth: '200px', height: '800px', minHeight: '600px' }"
   style="text-align: center;"
   [minY]="70"
   [maximizable]="true"
   [baseZIndex]="10000"
   [autoZIndex]="true"
>   
   <form name="Audiologist" #Audiologist="ngForm" novalidate>
      <div class="row">
         <div class="col-sm-6">
            <label class="control-label">Audiologist Name<sup class="text-danger">*</sup></label>
            <p-dropdown [options]="AudiologistList"
            name="Doctor_ID" 
            #Doctor_ID="ngModel" 
            [(ngModel)]="objAudiologist.Doctor_ID"
            [showClear]="true" 
            [emptyFilterMessage]="' No Audiologist Found'" 
            [filter]="true" filterBy="label,value.name" 
            [resetFilterOnHide]="true" 
            [placeholder]="'Select Audiologist'" 
            [virtualScroll]="true"
            itemSize="30"
            [styleClass]="AudiologistFormSubmitted &&  Doctor_ID.errors?.required ? 'clearance' :''"
            [required]="true"> 
            </p-dropdown>
         </div>
      </div>
   </form>
   <p-footer>
      <button class="btn btn-primary pull-right" (click)="SaveAudiologist(Audiologist.form.valid)" [disabled]="Spinner">
        <p-progressSpinner *ngIf="Spinner" [style]="{width: '15px', height: '15px'}" strokeWidth="8" animationDuration=".5s"></p-progressSpinner>
        <span *ngIf="!Spinner" class="glyphicon glyphicon-save"></span>Save
      </button>
      <button class="btn btn-primary" (click)="closePopup()" >
        <span class="glyphicon glyphicon-remove"></span>Close
      </button>
   </p-footer>
</p-dialog>

<p-dialog
   [header]="'Update Appointment'"
   [appendTo]="'body'"
   [visible]="displayPopupAppo"
   [closeOnEscape]="true"
   [closable]="false"
   [modal]="true"
   [responsive]="true"
   [style]="{ width: '100%', minWidth: '200px', minHeight: '700px' }"
   style="text-align: center;"
   [minY]="70"
   [maximizable]="true"
   [baseZIndex]="10000"
   [autoZIndex]="true"
 >   
   <form name="Appointment" #Appointment="ngForm" novalidate>

        <div class="row">
            <h5 style="background: #c1c1c185;
            border-top: 5px solid #3c8dbc;
            border-bottom: 1px solid #c6c6c6;
            height: 33px">
            <strong style="font-size: 20px; margin-left: 7px;">Details</strong>
            </h5>
        </div>
        
        <div class="row">
            <div class="col-sm-3">
                <label class="control-label">Patient Name</label>
                <div class="label-t">{{P_Name ? P_Name : '-'}}</div>
            </div>
            <div class="col-sm-3">
                <label class="control-label">Mobile</label>
                <div class="label-t">{{Phone ? Phone : '-'}}</div>
            </div>
            <div class="col-sm-3">
                <label class="control-label">Age</label>
                <div class="label-t">{{Age ? Age : '-'}}</div>
            </div>
            <div class="col-sm-3">
                <label class="control-label">Sex</label>
                <div class="label-t">{{Sex ? Sex : '-'}}</div>
            </div>
        </div>

        <div class="row">
            <div class="col-sm-3">
                <label class="control-label">Date</label>
                <div class="label-t">{{App_Date | date: "dd/MMM/yyyy"}}</div>
            </div>
            <div class="col-sm-4">
                <label class="control-label">Cost Centre Name</label>
                <div class="label-t">{{CostCen_Name ? CostCen_Name : '-'}}</div>
            </div>
            <div class="col-sm-5">
                <label class="control-label">Consultancy Name</label>
                <div class="label-t">{{Cons_Name ? Cons_Name : '-'}}</div>
            </div>
        </div>

        <div class="row">
            <div class="col-sm-4">
                <label class="control-label">Test Done</label>
                <p-multiSelect 
                        [options]="TestDoneList"
                        defaultLabel="Select Test"
                        [filter]="true" filterBy="label,value.name" 
                        name="Test_Done" 
                        #Test_Done="ngModel" 
                        [(ngModel)]="objAppointment.Test_Done"
                [styleClass]="'compacct-multiselect'" >
                </p-multiSelect>
            </div>
            <div class="col-sm-4">
                <label class="control-label">Audiogram Remarks</label>
                <textarea class="form-control" name="Audiogram_Remarks"  #Audiogram_Remarks="ngModel" 
                        [(ngModel)]="objAppointment.Audiogram_Remarks" ></textarea>
            </div>
            <div class="col-sm-4">
                <label class="control-label">Audiogram <sup *ngIf="databaseName === 'GN_Crystal_Mumbai'" class="text-danger">*</sup></label>
            <p-fileUpload #FileUploadAsset name="File" [multiple]="false" accept="image/*,.pdf" [customUpload]="true"
                [chooseLabel]="'Browse'" [showUploadButton]="true" (uploadHandler)="onBasicUpload(FileUploadAsset)">
                <ng-template let-File pTemplate="File">
                    <div class="ui-fileupload-row">
                        <div>
                            <a [href]="File.objectURL" target="_blank"><img
                                    [src]="File.type.includes('image') ? File.objectURL :''"
                                    width="50"></a>
                        </div>
                        <div>{{File.name}}</div>
                        <div>
                            <button type="button" class="btn btn-danger" (click)="onClear($event,File)"><i
                                    class="fa fa-fw fa-close"></i></button>
                        </div>
                    </div>
                </ng-template>
            </p-fileUpload>
            </div>

        </div>

        <hr class="box boxboxDivide-primary">

        <div class="row">
            <h5 style="background: #c1c1c185;
            border-top: 5px solid #3c8dbc;
            border-bottom: 1px solid #c6c6c6;
            height: 33px">
            <strong style="font-size: 20px; margin-left: 7px;">PTA Findings</strong>
            </h5>
        </div>

        <div class="row">

            <div class="col-sm-4">
                <h5 style="padding: 0.5em 1em;
                    background: #c1c1c185;
                    border-top: 5px solid #3c8dbc;
                    border-bottom: 1px solid #c6c6c6;
                    margin-top: -4px;">
                    <strong>Degree Of Loss</strong> 
                    </h5>
                    <div class="input-group" style="padding-bottom: 10px;">
                        <div class="input-group-addon">
                            <strong>Left</strong>
                        </div>
                        <p-dropdown [options]="DegreeLossList"
                                name="Degree_Of_Loss_L" 
                                #Degree_Of_Loss_L="ngModel" 
                                [(ngModel)]="objAppointment.Degree_Of_Loss_L"
                                [showClear]="true" 
                                [emptyFilterMessage]="' No Degree Of Loss List Found'" 
                                [filter]="true" filterBy="label,value.name" 
                                [resetFilterOnHide]="true" 
                                [placeholder]="'Select Degree of Loss'" 
                                [virtualScroll]="true"
                                [itemSize]="30"
                                [styleClass]="AppointmentFormSubmitted &&  Degree_Of_Loss_L.errors?.required ? 'clearance' :''"
                                [required]="true" >
                        </p-dropdown>
                    </div>
                    <div class="input-group">
                        <div class="input-group-addon">
                            <strong>Right</strong>
                        </div>
                        <p-dropdown [options]="DegreeLossList"
                                name="Degree_Of_Loss_R" 
                                #Degree_Of_Loss_R="ngModel" 
                                [(ngModel)]="objAppointment.Degree_Of_Loss_R"
                                [showClear]="true" 
                                [emptyFilterMessage]="' No Degree Of Loss List Found'" 
                                [filter]="true" filterBy="label,value.name" 
                                [resetFilterOnHide]="true" 
                                [placeholder]="'Select Degree of Loss'" 
                                [virtualScroll]="true"
                                [itemSize]="30"
                                [styleClass]="AppointmentFormSubmitted &&  Degree_Of_Loss_R.errors?.required ? 'clearance' :''"
                                [required]="true" >
                        </p-dropdown>
                    </div>    
            </div>

            <div class="col-sm-4">
                <h5 style="padding: 0.5em 1em;
                    background: #c1c1c185;
                    border-top: 5px solid #3c8dbc;
                    border-bottom: 1px solid #c6c6c6;
                    margin-top: -4px;">
                    <strong>Types Of Loss</strong> 
                </h5>
                    <div class="input-group" style="padding-bottom: 10px;">
                        <div class="input-group-addon">
                            <strong>Left</strong>
                        </div>
                        <select class="form-control"
                            [ngClass]="{clearance: AppointmentFormSubmitted && Type_Of_Loss_L?.errors?.required }" 
                            required
                            (change)="HAYesNoL()"
                            name="Type_Of_Loss_L"
                            #Type_Of_Loss_L="ngModel" 
                            [(ngModel)]="objAppointment.Type_Of_Loss_L"
                            >
                            <option  [ngValue]="undefined">Select</option>
                            <option  *ngFor="let option of TypeLossList" value="{{option}}">
                                {{option}}
                            </option>
                        </select>
                    </div>
                    <div class="input-group">
                        <div class="input-group-addon">
                            <strong>Right</strong>
                        </div>
                        <select class="form-control"
                            [ngClass]="{clearance: AppointmentFormSubmitted && Type_Of_Loss_R?.errors?.required }" 
                            required
                            (change)="HAYesNoR()"
                            name="Type_Of_Loss_R"
                            #Type_Of_Loss_R="ngModel" 
                            [(ngModel)]="objAppointment.Type_Of_Loss_R"
                            >
                            <option  [ngValue]="undefined">Select</option>
                            <option  *ngFor="let option of TypeLossList" value="{{option}}">
                                {{option}}
                            </option>
                        </select>
                    </div>    
            </div>

            <div class="col-sm-4">
                <h5 style="padding: 0.5em 1em;
                    background: #c1c1c185;
                    border-top: 5px solid #3c8dbc;
                    border-bottom: 1px solid #c6c6c6;
                    margin-top: -4px;">
                    <strong>HA Required</strong> 
                </h5>
                    <div class="input-group" style="padding-bottom: 10px;">
                        <div class="input-group-addon">
                            <strong>Left</strong>
                        </div>
                        <select class="form-control"
                            [ngClass]="{clearance: AppointmentFormSubmitted && HA_Req_L?.errors?.required }" 
                            required
                            (change)="TrialDoneOnOFF()"
                            name="HA_Req_L"
                            #HA_Req_L="ngModel" 
                            [(ngModel)]="objAppointment.HA_Req_L"
                            >
                            <option  [ngValue]="undefined">Select</option>
                            <option  *ngFor="let option of HAYesNoListL" value="{{option}}">
                                {{option}}
                            </option>
                        </select>
                    </div>
                    <div class="input-group">
                        <div class="input-group-addon">
                            <strong>Right</strong>
                        </div>
                        <select class="form-control"
                            [ngClass]="{clearance: AppointmentFormSubmitted && HA_Req_R?.errors?.required }" 
                            required
                            (change)="TrialDoneOnOFF()"
                            name="HA_Req_R"
                            #HA_Req_R="ngModel" 
                            [(ngModel)]="objAppointment.HA_Req_R"
                            >
                            <option  [ngValue]="undefined">Select</option>
                            <option  *ngFor="let option of HAYesNoListR" value="{{option}}">
                                {{option}}
                            </option>
                        </select>
                    </div>    
            </div>

        </div>

        <div class="row" style="margin-top: 12px;" *ngIf="TrialDoneOpen">
            <div class="col-sm-4">
                <label class="control-label">TRIAL DONE</label>
                <select class="form-control"
                    name="Trial_Done"
                    #Trial_Done="ngModel"
                    [(ngModel)]="objAppointment.Trial_Done"
                    (change)="TrialUpdateOnOFF()"
                    [ngClass]="{clearance: AppointmentFormSubmitted && Trial_Done?.errors?.required }" 
                    required
                >
                 <option  [ngValue]="undefined">Select</option>
                 <option  *ngFor="let option of YesNoList" value="{{option}}">
                     {{option}}
                 </option>
                </select>
            </div>
        </div>

        <hr class="box boxboxDivide-primary">

        <div *ngIf="TrialUpdateOpen">
            <div class="row">
                <h5 style="background: #c1c1c185;
                border-top: 5px solid #3c8dbc;
                border-bottom: 1px solid #c6c6c6;
                height: 33px">
                <strong style="font-size: 20px; margin-left: 7px;">TRIAL UPDATE</strong>
                </h5>
            </div>

            <div class="row">
                <div class="col-sm-4">
                    <label class="control-label">EXPERIENCE USER</label>
                    <select class="form-control"
                        name="EXPERIENCE_USER"
                        #EXPERIENCE_USER="ngModel"
                        [(ngModel)]="objAppointment.EXPERIENCE_USER"
                        [ngClass]="{clearance: AppointmentFormSubmitted && EXPERIENCE_USER?.errors?.required }" 
                        required
                    >
                     <option  [ngValue]="undefined">Select</option>
                     <option  *ngFor="let option of YesNoList" value="{{option}}">
                         {{option}}
                     </option>
                    </select>
                </div>

                <div class="col-sm-4">
                    <label class="control-label">Binaural/Monorual</label>
                    <select class="form-control"
                        name="Trial_For"
                        #Trial_For="ngModel"
                        (change)="MonorualOnOFF()"
                        [(ngModel)]="objAppointment.Trial_For"
                        [ngClass]="{clearance: AppointmentFormSubmitted && Trial_For?.errors?.required }" 
                        required
                    >
                     <option  [ngValue]="undefined">Select</option>
                     <option  *ngFor="let option of Trial_ForList" value="{{option}}">
                         {{option}}
                     </option>
                    </select>
                </div>

                <div class="col-sm-4" *ngIf="MonorualOpen">
                    <label class="control-label">If Monorual</label>
                    <input class="form-control"
                        name="Trial_For_Mono_Reason"
                        #Trial_For_Mono_Reason="ngModel"
                        [(ngModel)]="objAppointment.Trial_For_Mono_Reason" 
                        [ngClass]="{clearance: AppointmentFormSubmitted && Trial_For_Mono_Reason?.errors?.required }"
                        required
                        placeholder="Type reason" > 
                </div>
            </div>

            <div class="row" style="margin-top: 12px;">
                <div class="col-sm-6">
                    <div class="panel panel-primary">
                        <div class="panel-body">
                            <form name="LeftProductTrial" #LeftProductTrial="ngForm" novalidate>
                                <div class="col-sm-8">
                                    <label class="control-label">Product Trial (Left)</label>
                                    <p-dropdown [options]="ProductList"
                                        name="ProTrialLeft" 
                                        #ProTrialLeft="ngModel" 
                                        [(ngModel)]="ProductTrialLeft"
                                        [showClear]="true" 
                                        [emptyFilterMessage]="' No Product Found'" 
                                        [filter]="true" filterBy="label,value.name" 
                                        [resetFilterOnHide]="true" 
                                        [placeholder]="'Select Product'" 
                                        [virtualScroll]="true"
                                        [itemSize]="30"
                                        [styleClass]="PTLFormSubmitted &&  ProTrialLeft.errors?.required ? 'clearance' :''"
                                        [required]="true" >
                                    </p-dropdown>
                                </div>
                                <div class="col-sm-2" style="margin-top: 26px;">
                                    <button class="btn btn-primary" (click)="addProductTrialLeft(LeftProductTrial.form.valid)">
                                    Add
                                    </button>        
                                </div>
                            </form>    
                        </div>
                    </div>
                </div>

                <div class="col-sm-6">
                    <div class="panel panel-primary">
                        <div class="panel-body">
                            <form name="RightProductTrial" #RightProductTrial="ngForm" novalidate>
                                <div class="col-sm-8">
                                    <label class="control-label">Product Trial (Right)</label>
                                    <p-dropdown [options]="ProductList"
                                        name="ProTrialRight" 
                                        #ProTrialRight="ngModel" 
                                        [(ngModel)]="ProductTrialRight"
                                        [showClear]="true" 
                                        [emptyFilterMessage]="' No Product Found'" 
                                        [filter]="true" filterBy="label,value.name" 
                                        [resetFilterOnHide]="true" 
                                        [placeholder]="'Select Product'" 
                                        [virtualScroll]="true"
                                        [itemSize]="30"
                                        [styleClass]="PTRFormSubmitted &&  ProTrialRight.errors?.required ? 'clearance' :''"
                                        [required]="true" >
                                    </p-dropdown>
                                </div>
                                <div class="col-sm-2" style="margin-top: 26px;">
                                    <button class="btn btn-primary" (click)="addProductTrialRight(RightProductTrial.form.valid)">
                                    Add
                                    </button>        
                                </div>
                            </form>    
                        </div>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-sm-6">
                    <div class="table-responsive no-padding">
                        <table class="table table-bordered">
                            <thead>
                                <tr style="background-color:#3c8dbc;color:white;">
                                    <th>SL No.</th>
                                    <th>Product Trial (Left)</th>
                                    <th>Delete</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr *ngFor="let obj of PTLList ;let ind = index;">
                                    <td>{{ ind + 1 }}</td>
                                    <td>{{obj.Product_Description ? obj.Product_Description : '-'}}</td>
                                    <td><button (click)="deleteProductTrialLeft(ind)" class="btn btn-danger"><i class="fa fa-trash"></i></button></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="col-sm-6">
                    <div class="table-responsive no-padding">
                        <table class="table table-bordered">
                            <thead>
                                <tr style="background-color:#3c8dbc;color:white;">
                                    <th>SL No.</th>
                                    <th>Product Trial (Right)</th>
                                    <th>Delete</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr *ngFor="let obj of PTRList ;let ind = index;">
                                    <td>{{ ind + 1 }}</td>
                                    <td>{{obj.Product_Description ? obj.Product_Description : '-'}}</td>
                                    <td><button (click)="deleteProductTrialRight(ind)" class="btn btn-danger"><i class="fa fa-trash"></i></button></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <div class="row" style="margin-top: 12px;">
                <div class="col-sm-6">
                    <div class="panel panel-primary">
                        <div class="panel-body">
                            <form name="LeftProductSelect" #LeftProductSelect="ngForm" novalidate>
                                <div class="col-sm-8">
                                    <label class="control-label">Product Select (Left)</label>
                                    <p-dropdown [options]="ProductList"
                                        name="ProSelectLeft" 
                                        #ProSelectLeft="ngModel" 
                                        [(ngModel)]="ProductSelectLeft"
                                        [showClear]="true" 
                                        [emptyFilterMessage]="' No Product Found'" 
                                        [filter]="true" filterBy="label,value.name" 
                                        [resetFilterOnHide]="true" 
                                        [placeholder]="'Select Product'" 
                                        [virtualScroll]="true"
                                        [itemSize]="30"
                                        [styleClass]="PSLFormSubmitted &&  ProSelectLeft.errors?.required ? 'clearance' :''"
                                        [required]="true" >
                                    </p-dropdown>
                                </div>
                                <div class="col-sm-2" style="margin-top: 26px;">
                                    <button class="btn btn-primary" (click)="addProductSelectLeft(LeftProductSelect.form.valid)">
                                    Add
                                    </button>        
                                </div>
                            </form>    
                        </div>
                    </div>
                </div>

                <div class="col-sm-6">
                    <div class="panel panel-primary">
                        <div class="panel-body">
                            <form name="RightProductSelect" #RightProductSelect="ngForm" novalidate>
                                <div class="col-sm-8">
                                    <label class="control-label">Product Select (Right)</label>
                                    <p-dropdown [options]="ProductList"
                                        name="ProSelectRight" 
                                        #ProSelectRight="ngModel" 
                                        [(ngModel)]="ProductSelectRight"
                                        [showClear]="true" 
                                        [emptyFilterMessage]="' No Product Found'" 
                                        [filter]="true" filterBy="label,value.name" 
                                        [resetFilterOnHide]="true" 
                                        [placeholder]="'Select Product'" 
                                        [virtualScroll]="true"
                                        [itemSize]="30"
                                        [styleClass]="PSRFormSubmitted &&  ProSelectRight.errors?.required ? 'clearance' :''"
                                        [required]="true" >
                                    </p-dropdown>
                                </div>
                                <div class="col-sm-2" style="margin-top: 26px;">
                                    <button class="btn btn-primary" (click)="addProductSelectRight(RightProductSelect.form.valid)">
                                    Add
                                    </button>        
                                </div>
                            </form>    
                        </div>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-sm-6">
                    <div class="table-responsive no-padding">
                        <table class="table table-bordered">
                            <thead>
                                <tr style="background-color:#3c8dbc;color:white;">
                                    <th>SL No.</th>
                                    <th>Product Select (Left)</th>
                                    <th>Delete</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr *ngFor="let obj of PSLList ;let ind = index;">
                                    <td>{{ ind + 1 }}</td>
                                    <td>{{obj.Product_Description ? obj.Product_Description : '-'}}</td>
                                    <td><button (click)="deleteProductSelectLeft(ind)" class="btn btn-danger"><i class="fa fa-trash"></i></button></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="col-sm-6">
                    <div class="table-responsive no-padding">
                        <table class="table table-bordered">
                            <thead>
                                <tr style="background-color:#3c8dbc;color:white;">
                                    <th>SL No.</th>
                                    <th>Product Select (Right)</th>
                                    <th>Delete</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr *ngFor="let obj of PSRList ;let ind = index;">
                                    <td>{{ ind + 1 }}</td>
                                    <td>{{obj.Product_Description ? obj.Product_Description : '-'}}</td>
                                    <td><button (click)="deleteProductSelectRight(ind)" class="btn btn-danger"><i class="fa fa-trash"></i></button></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <div class="row" style="margin-top: 2px;">
                <div class="col-sm-2">
                    <label class="control-label">Restult <sup *ngIf="databaseName === 'GN_Crystal_Mumbai'" class="text-danger">*</sup></label>
                    <select class="form-control"
                        name="Trial_Restult"
                        #Trial_Restult="ngModel"
                        [(ngModel)]="objAppointment.Trial_Restult"
                        (change)="MISSEDOnOFF()"
                        [ngClass]="{clearance: AppointmentFormSubmitted && Trial_Restult?.errors?.required }" 
                        required
                    >
                     <option  [ngValue]="undefined">Select</option>
                     <option  *ngFor="let option of TrialRestultList" value="{{option}}">
                         {{option}}
                     </option>
                    </select>
                </div>

                <div class="col-sm-3" *ngIf="objAppointment.Trial_Restult == 'MISSED'">
                    <label class="control-label">Reason <sup *ngIf="databaseName === 'GN_Crystal_Mumbai'" class="text-danger">*</sup></label>
                    <p-multiSelect 
                        [options]="MissedReasonList"
                        defaultLabel="Select Reason"
                        [filter]="true" filterBy="label,value.name" 
                        name="Trail_Missed_Reason" 
                        #Trail_Missed_Reason="ngModel" 
                        [(ngModel)]="objAppointment.Trail_Missed_Reason"
                        [ngClass]="{clearance: AppointmentFormSubmitted && Trail_Missed_Reason?.errors?.required }" 
                        required
                        [styleClass]="'compacct-multiselect'" >
                    </p-multiSelect>    
                </div>
                <div class="col-sm-3" *ngIf="(MISSEDOpen) && (databaseName === 'GN_Crystal_Mumbai')">
                    <label class="control-label">Final Price Offered After Discount <sup class="text-danger">*</sup></label>
                    <input class="form-control" name="Price" #Price="ngModel" [(ngModel)]="objAppointment.Final_Price_After_Disc" CompacctDigitonly="true" [ngClass]="{'clearance':AppointmentFormSubmitted && Price?.errors?.required}" required>

                </div>
                <div class="col-sm-2" *ngIf="(objAppointment.Trial_Restult === 'ON TRIAL') && (databaseName === 'GN_Crystal_Mumbai')">
                    <label class="control-label">For Days <sup class="text-danger"></sup></label>
                    <div class="input-group">  
                        <input class="form-control" name="fordays" #fordays="ngModel"
                        [(ngModel)]="objAppointment.Trial_days"
                        placeholder="For Days"
                        CompacctDigitonly="true"
                        [ngClass]="{'clearance':AppointmentFormSubmitted && fordays?.errors?.required}"
                        >
                            <span class="input-group-addon">
                                Days
                            </span>
                    </div>
                </div>
            </div>
        </div>
        
        <hr class="box boxboxDivide-primary">

        <div class="row">
            <h5 style="background: #c1c1c185;
            border-top: 5px solid #3c8dbc;
            border-bottom: 1px solid #c6c6c6;
            height: 33px">
            <strong style="font-size: 20px; margin-left: 7px;">Comments</strong>
            </h5>
        </div>

        <div class="row">
            <div class="col-sm-4">
                <label class="control-label">Remarks <sup *ngIf="databaseName === 'GN_Crystal_Mumbai'" class="text-danger">*</sup></label>
                <input class="form-control"
                    name="Remarks"
                    #Remarks="ngModel"
                    [(ngModel)]="objAppointment.Remarks" 
                    [ngClass]="{clearance: AppointmentFormSubmitted && Remarks?.errors?.required }"
                    required
                placeholder="Write Here" > 
            </div>
        </div>

   </form>
   <p-footer>
      <button class="btn btn-primary pull-right" (click)="SaveAppointment(Appointment.form.valid)" [disabled]="AppoSpinner">
        <p-progressSpinner *ngIf="AppoSpinner" [style]="{width: '15px', height: '15px'}" strokeWidth="8" animationDuration=".5s"></p-progressSpinner>
        <span *ngIf="!AppoSpinner" class="glyphicon glyphicon-refresh"></span>Update
      </button>
      <button class="btn btn-primary" (click)="closePopupAppo()" >
        <span class="glyphicon glyphicon-remove"></span>Close
      </button>
   </p-footer>
</p-dialog>

<p-dialog
   [header]="'View Appointment'"
   [appendTo]="'body'"
   [visible]="displayPopupAppoView"
   [closeOnEscape]="true"
   [closable]="false"
   [modal]="true"
   [responsive]="true"
   [style]="{ width: '100%', minWidth: '200px', minHeight: '700px' }"
   style="text-align: center;"
   [minY]="70"
   [maximizable]="true"
   [baseZIndex]="10000"
   [autoZIndex]="true"
 >  

    <div>

        <div class="row">
            <h5 style="background: #c1c1c185;
            border-top: 5px solid #3c8dbc;
            border-bottom: 1px solid #c6c6c6;
            height: 33px">
            <strong style="font-size: 20px; margin-left: 7px;">Details</strong>
            </h5>
        </div>

        <div class="row">
            <div class="col-sm-3">
                <label class="control-label">Patient Name</label>
                <div class="label-t">{{P_Name ? P_Name : '-'}}</div>
            </div>
            <div class="col-sm-3">
                <label class="control-label">Mobile</label>
                <div class="label-t">{{Phone ? Phone : '-'}}</div>
            </div>
            <div class="col-sm-3">
                <label class="control-label">Age</label>
                <div class="label-t">{{Age ? Age : '-'}}</div>
            </div>
            <div class="col-sm-3">
                <label class="control-label">Sex</label>
                <div class="label-t">{{Sex ? Sex : '-'}}</div>
            </div>
        </div>

        <div class="row">
            <div class="col-sm-3">
                <label class="control-label">Date</label>
                <div class="label-t">{{App_Date ? (App_Date | date: "dd/MMM/yyyy") : '-'}}</div>
            </div>
            <div class="col-sm-4">
                <label class="control-label">Cost Centre Name</label>
                <div class="label-t">{{CostCen_Name ? CostCen_Name : '-'}}</div>
            </div>
            <div class="col-sm-5">
                <label class="control-label">Consultancy Name</label>
                <div class="label-t">{{Cons_Name ? Cons_Name : '-'}}</div>
            </div>
        </div>

        <div class="row">
            <div class="col-sm-4">
                <label class="control-label">Test Done</label>
                <div class="label-t">{{objAppointment.Test_Done ? objAppointment.Test_Done : '-'}}</div>
            </div>
            <div class="col-sm-4">
                <label class="control-label">Audiogram Remarks</label>
                <div class="label-t">{{objAppointment.Audiogram_Remarks ? objAppointment.Audiogram_Remarks : '-'}}</div>
            </div>
            <div class="col-sm-4">
                <label class="control-label">Audiogram</label>
                <div>
                    <button type="button" class="btn btn-outline-info" (click)="getImage(objAppointment.Audiogram)">Audiogram info</button>
                </div>
               
            </div>
        </div>

        <hr class="box boxboxDivide-primary">

        <div class="row">
            <h5 style="background: #c1c1c185;
            border-top: 5px solid #3c8dbc;
            border-bottom: 1px solid #c6c6c6;
            height: 33px">
            <strong style="font-size: 20px; margin-left: 7px;">PTA Findings</strong>
            </h5>
        </div>

        <div class="row">
            <div class="col-sm-4">
                    <h5 style="padding: 0.5em 1em;
                    background: #c1c1c185;
                    border-top: 5px solid #3c8dbc;
                    border-bottom: 1px solid #c6c6c6;
                    margin-top: -4px;">
                    <strong>Degree Of Loss</strong> 
                    </h5>
                    <div class="input-group" style="padding-bottom: 10px;">
                        <div class="input-group-addon">
                            <strong>Left</strong>
                        </div>
                        <div class="label-t">{{objAppointment.Degree_Of_Loss_L ? objAppointment.Degree_Of_Loss_L : '-'}}</div>
                    </div>
                    <div class="input-group">
                        <div class="input-group-addon">
                            <strong>Right</strong>
                        </div>
                        <div class="label-t">{{objAppointment.Degree_Of_Loss_R ? objAppointment.Degree_Of_Loss_R : '-'}}</div>
                    </div>    
            </div>

            <div class="col-sm-4">
                    <h5 style="padding: 0.5em 1em;
                        background: #c1c1c185;
                        border-top: 5px solid #3c8dbc;
                        border-bottom: 1px solid #c6c6c6;
                        margin-top: -4px;">
                        <strong>Types Of Loss</strong> 
                    </h5>
                    <div class="input-group" style="padding-bottom: 10px;">
                        <div class="input-group-addon">
                            <strong>Left</strong>
                        </div>
                        <div class="label-t">{{objAppointment.Type_Of_Loss_L ? objAppointment.Type_Of_Loss_L : '-'}}</div>
                    </div>
                    <div class="input-group">
                        <div class="input-group-addon">
                            <strong>Right</strong>
                        </div>
                        <div class="label-t">{{objAppointment.Type_Of_Loss_R ? objAppointment.Type_Of_Loss_R : '-'}}</div>
                    </div>    
            </div>

            <div class="col-sm-4">
                    <h5 style="padding: 0.5em 1em;
                        background: #c1c1c185;
                        border-top: 5px solid #3c8dbc;
                        border-bottom: 1px solid #c6c6c6;
                        margin-top: -4px;">
                        <strong>HA Required</strong> 
                    </h5>
                    <div class="input-group" style="padding-bottom: 10px;">
                        <div class="input-group-addon">
                            <strong>Left</strong>
                        </div>
                        <div class="label-t">{{objAppointment.HA_Req_L ? objAppointment.HA_Req_L : '-'}}</div>
                    </div>
                    <div class="input-group">
                        <div class="input-group-addon">
                            <strong>Right</strong>
                        </div>
                        <div class="label-t">{{objAppointment.HA_Req_R ? objAppointment.HA_Req_R : '-'}}</div>
                    </div>    
            </div>
        </div>

        <div class="row" style="margin-top: 12px;" *ngIf="TrialDoneOpen">
            <div class="col-sm-4">
                <label class="control-label">TRIAL DONE</label>
                <div class="label-t">{{objAppointment.Trial_Done ? objAppointment.Trial_Done : '-'}}</div>
            </div>
        </div>

        <hr class="box boxboxDivide-primary">

        <div *ngIf="TrialUpdateOpen">
            <div class="row">
                <h5 style="background: #c1c1c185;
                border-top: 5px solid #3c8dbc;
                border-bottom: 1px solid #c6c6c6;
                height: 33px">
                <strong style="font-size: 20px; margin-left: 7px;">TRIAL UPDATE</strong>
                </h5>
            </div>

            <div class="row">
                <div class="col-sm-4">
                    <label class="control-label">EXPERIENCE USER</label>
                    <div class="label-t">{{objAppointment.EXPERIENCE_USER ? objAppointment.EXPERIENCE_USER : '-'}}</div>
                </div>
               
                <div class="col-sm-4">
                    <label class="control-label">Binaural/Monorual</label>
                    <div class="label-t">{{objAppointment.Trial_For ? objAppointment.Trial_For : '-'}}</div>
                </div>

                <div class="col-sm-4" *ngIf="MonorualOpen">
                    <label class="control-label">If Monorual</label>
                    <div class="label-t">{{objAppointment.Trial_For_Mono_Reason ? objAppointment.Trial_For_Mono_Reason : '-'}}</div>
                </div>
            </div>

            <div class="row" style="margin-top: 20px;">
                <div class="col-sm-6">
                    <div class="table-responsive no-padding">
                        <table class="table table-bordered">
                            <thead>
                                <tr style="background-color:#3c8dbc;color:white;">
                                    <th>SL No.</th>
                                    <th>Product Trial (Left)</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr *ngFor="let obj of PTLList ;let ind = index;">
                                    <td>{{ ind + 1 }}</td>
                                    <td>{{obj.Product_Description ? obj.Product_Description : '-'}}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="col-sm-6">
                    <div class="table-responsive no-padding">
                        <table class="table table-bordered">
                            <thead>
                                <tr style="background-color:#3c8dbc;color:white;">
                                    <th>SL No.</th>
                                    <th>Product Trial (Right)</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr *ngFor="let obj of PTRList ;let ind = index;">
                                    <td>{{ ind + 1 }}</td>
                                    <td>{{obj.Product_Description ? obj.Product_Description : '-'}}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <div class="row" style="margin-top: 5px;">
                <div class="col-sm-6">
                    <div class="table-responsive no-padding">
                        <table class="table table-bordered">
                            <thead>
                                <tr style="background-color:#3c8dbc;color:white;">
                                    <th>SL No.</th>
                                    <th>Product Select (Left)</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr *ngFor="let obj of PSLList ;let ind = index;">
                                    <td>{{ ind + 1 }}</td>
                                    <td>{{obj.Product_Description ? obj.Product_Description : '-'}}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="col-sm-6">
                    <div class="table-responsive no-padding">
                        <table class="table table-bordered">
                            <thead>
                                <tr style="background-color:#3c8dbc;color:white;">
                                    <th>SL No.</th>
                                    <th>Product Select (Right)</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr *ngFor="let obj of PSRList ;let ind = index;">
                                    <td>{{ ind + 1 }}</td>
                                    <td>{{obj.Product_Description ? obj.Product_Description : '-'}}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <div class="row" style="margin-top: 2px;">
                <div class="col-sm-2">
                    <label class="control-label">Restult</label>
                    <div class="label-t">{{objAppointment.Trial_Restult ? objAppointment.Trial_Restult : '-'}}</div>
                </div>

                <div class="col-sm-3" *ngIf="MISSEDOpen">
                    <label class="control-label">Reason</label>
                    <div class="label-t">{{objAppointment.Trail_Missed_Reason ? objAppointment.Trail_Missed_Reason : '-'}}</div>
                </div>

                <div class="col-sm-3" *ngIf="(MISSEDOpen) && (databaseName === 'GN_Crystal_Mumbai')">
                    <label class="control-label">Final Price Offered After Discount <sup *ngIf="databaseName === 'GN_Crystal_Mumbai'" class="text-danger">*</sup></label>
                    <div class="label-t">{{objAppointment.Final_Price_After_Disc ? objAppointment.Final_Price_After_Disc : '-'}}</div>
                </div>

                <div class="col-sm-2" *ngIf="(objAppointment.Trial_Restult === 'ON TRIAL') && (databaseName === 'GN_Crystal_Mumbai')">
                    <label class="control-label">For Days <sup class="text-danger">*</sup></label>
                    <div class="input-group">  
                        <div class="label-t">{{objAppointment.Trial_days ? objAppointment.Trial_days : '-'}}</div>
                            <span class="input-group-addon">
                                Days
                            </span>
                    </div>
                </div>
            </div>
        </div>

        <hr class="box boxboxDivide-primary">

        <div class="row">
            <h5 style="background: #c1c1c185;
            border-top: 5px solid #3c8dbc;
            border-bottom: 1px solid #c6c6c6;
            height: 33px">
            <strong style="font-size: 20px; margin-left: 7px;">Comments</strong>
            </h5>
        </div>

        <div class="row">
            <div class="col-sm-4">
                <label class="control-label">Remarks</label>
                <div class="label-t">{{objAppointment.Remarks ? objAppointment.Remarks : '-'}}</div>
            </div>
        </div>

    </div>

    <p-footer>
        <button class="btn btn-primary" (click)="closePopupAppoView()" >
        <span class="glyphicon glyphicon-remove"></span>Close
        </button>
    </p-footer>
</p-dialog>

<p-dialog
   [header]="'Reprogramming & Other test'"
   [appendTo]="'body'"
   [visible]="displayPopupPro"
   [closeOnEscape]="true"
   [closable]="false"
   [modal]="true"
   [responsive]="false"
   [style]="{ width: '60%', minWidth: '200px', height: '600px', minHeight: '400px' }"
   style="text-align: center;"
   [minY]="70"
   [maximizable]="true"
   [baseZIndex]="10000"
   [autoZIndex]="true"
>   
   <form name="Programming" #Programming="ngForm" novalidate>
      <div class="row">
         <div class="col-sm-8">
            <label class="control-label">Reprogramming or if any other test where type and degree of HL not known<sup class="text-danger">*</sup></label>
            <input class="form-control"
                name="Audio_Note"
                #Audio_Note="ngModel"
                [(ngModel)]="objProgramming.Audio_Note" 
                [ngClass]="{clearance: ProgrammingFormSubmitted && Audio_Note?.errors?.required }"
                required
            placeholder="Comment Here" > 
         </div>
      </div>
   </form>
   <p-footer>
      <button class="btn btn-primary pull-right" (click)="SaveUpdateProgramming(Programming.form.valid)" [disabled]="ProSpinner">
        <p-progressSpinner *ngIf="ProSpinner" [style]="{width: '15px', height: '15px'}" strokeWidth="8" animationDuration=".5s"></p-progressSpinner>
        <span *ngIf="!ProSpinner" class="glyphicon glyphicon-save"></span>Save
      </button>
      <button class="btn btn-primary" (click)="closePopupPro()" >
        <span class="glyphicon glyphicon-remove"></span>Close
      </button>
   </p-footer>
</p-dialog>

<p-dialog
   [header]="'Reprogramming & Other test'"
   [appendTo]="'body'"
   [visible]="displayPopupProView"
   [closeOnEscape]="true"
   [closable]="false"
   [modal]="true"
   [responsive]="false"
   [style]="{ width: '60%', minWidth: '200px', height: '600px', minHeight: '400px' }"
   style="text-align: center;"
   [minY]="70"
   [maximizable]="true"
   [baseZIndex]="10000"
   [autoZIndex]="true"
>   
    <div>
        <div class="col-sm-8">
            <label class="control-label">Reprogramming or if any other test where type and degree of HL not known</label>
            <div class="label-t">{{objProgramming.Audio_Note ? objProgramming.Audio_Note : '-'}}</div>
        </div>
    </div>
    <p-footer>
      <button class="btn btn-primary" (click)="closePopupProView()" >
        <span class="glyphicon glyphicon-remove"></span>Close
      </button>
    </p-footer>
</p-dialog>

<!-- For Crystall -->
<p-dialog
   [header]="'Update Appointment'"
   [appendTo]="'body'"
   [visible]="displayPopupUpdateAppoNo"
   [closeOnEscape]="true"
   [closable]="false"
   [modal]="true"
   [responsive]="true"
   [style]="{ width: '100%', minWidth: '200px', minHeight: '700px' }"
   style="text-align: center;"
   [minY]="70"
   [maximizable]="true"
   [baseZIndex]="10000"
   [autoZIndex]="true"
 >   
   <form name="AppointmentNo" #AppointmentNo="ngForm" novalidate>

        <div class="row">
            <h5 style="background: #c1c1c185;
            border-top: 5px solid #3c8dbc;
            border-bottom: 1px solid #c6c6c6;
            height: 33px">
            <strong style="font-size: 20px; margin-left: 7px;">Details</strong>
            </h5>
        </div>
        
        <div class="row">
            <div class="col-sm-3">
                <label class="control-label">Patient Name</label>
                <div class="label-t">{{P_NameNo ? P_NameNo : '-'}}</div>
            </div>
            <div class="col-sm-3">
                <label class="control-label">Mobile</label>
                <div class="label-t">{{PhoneNo ? PhoneNo : '-'}}</div>
            </div>
            <div class="col-sm-3">
                <label class="control-label">Age</label>
                <div class="label-t">{{AgeNo ? AgeNo : '-'}}</div>
            </div>
            <div class="col-sm-3">
                <label class="control-label">Sex</label>
                <div class="label-t">{{SexNo ? SexNo : '-'}}</div>
            </div>
        </div>

        <div class="row">
            <div class="col-sm-3">
                <label class="control-label">Date</label>
                <div class="label-t">{{App_DateNo | date: "dd/MMM/yyyy"}}</div>
            </div>
            <div class="col-sm-4">
                <label class="control-label">Cost Centre Name</label>
                <div class="label-t">{{CostCen_NameNo ? CostCen_NameNo : '-'}}</div>
            </div>
            <div class="col-sm-5">
                <label class="control-label">Consultancy Name</label>
                <div class="label-t">{{Cons_NameNo ? Cons_NameNo : '-'}}</div>
            </div>
        </div>

        <div class="row">
            <div class="col-sm-4">
                <label class="control-label">Test Done <sup class="text-danger">*</sup></label>
                <select class="form-control"
                        name="testdoneappono"
                        #testdoneappono="ngModel"
                        [(ngModel)]="objAppointmentNo.Other_Test_done"
                        (change)="clearOther_Test_done()"
                        [ngClass]="{clearance: AppointmentNoFormSubmitted && testdoneappono?.errors?.required }" 
                        required>
                     <option  [ngValue]="undefined">Select</option>
                     <option  *ngFor="let option of TestDoneListAppoNo" value="{{option}}">
                         {{option}}
                     </option>
                </select>
            </div>
            <div class="col-sm-4" *ngIf="objAppointmentNo.Other_Test_done === 'Others'">
                <label class="control-label">Others Details <sup class="text-danger">*</sup></label>
                <textarea class="form-control" name="otherstestdone"  #otherstestdone="ngModel" 
                        [(ngModel)]="objAppointmentNo.Other_Test_Details" 
                        [ngClass]="{clearance: AppointmentNoFormSubmitted && otherstestdone?.errors?.required }" required>
                </textarea>
            </div>

        </div>
        

   </form>
   <p-footer>
      <button class="btn btn-primary pull-right" (click)="SaveAppointmentNo(AppointmentNo.form.valid)" [disabled]="AppoNoSpinner">
        <p-progressSpinner *ngIf="AppoNoSpinner" [style]="{width: '15px', height: '15px'}" strokeWidth="8" animationDuration=".5s"></p-progressSpinner>
        <span *ngIf="!AppoNoSpinner" class="glyphicon glyphicon-refresh"></span>Update
      </button>
      <button class="btn btn-primary" (click)="closePopupAppoNo()" >
        <span class="glyphicon glyphicon-remove"></span>Close
      </button>
   </p-footer>
</p-dialog>

<p-dialog
   [header]="'Other test'"
   [appendTo]="'body'"
   [visible]="displayViewTestPOP"
   [closeOnEscape]="true"
   [closable]="false"
   [modal]="true"
   [responsive]="false"
   [style]="{ width: '60%', minWidth: '200px', height: '600px', minHeight: '400px' }"
   style="text-align: center;"
   [minY]="70"
   [maximizable]="true"
   [baseZIndex]="10000"
   [autoZIndex]="true"
>   
    <div class="form-group">
        <div class="col-sm-4">
            <label class="control-label">Patient Name</label>
            <div class="label-t">{{ObjTestDetails.Patient ? ObjTestDetails.Patient : '-'}}</div>
        </div>
        <div class="col-sm-4">
            <label class="control-label">Mobile</label>
            <div class="label-t">{{ObjTestDetails.Mobile ? ObjTestDetails.Mobile : '-'}}</div>
        </div>
        <div class="col-sm-4">
            <label class="control-label">Age</label>
            <div class="label-t">{{ObjTestDetails.Age ? ObjTestDetails.Age : '-'}}</div>
        </div>
    </div>
    <div class="form-group">
        <div class="col-sm-4">
            <label class="control-label">Sex</label>
            <div class="label-t">{{ObjTestDetails.Sex ? ObjTestDetails.Sex : '-'}}</div>
        </div>
        <div class="col-sm-4">
            <label class="control-label">Date</label>
            <div class="label-t">{{ObjTestDetails.Appo_Dt ? (ObjTestDetails.Appo_Dt | date: "dd/MMM/yyyy") : '-'}}</div>
        </div>
        <div class="col-sm-4">
            <label class="control-label">Cost Center Name</label>
            <div class="label-t">{{ObjTestDetails.Cost_Cen_Name ? ObjTestDetails.Cost_Cen_Name : '-'}}</div>
        </div>
    </div>
    <div class="form-group">
        <div class="col-sm-4">
            <label class="control-label">Consultancy Name</label>
            <div class="label-t">{{ObjTestDetails.Consultancy ? ObjTestDetails.Consultancy : '-'}}</div>
        </div>
        <div class="col-sm-4">
            <label class="control-label">Test</label>
            <div class="label-t">{{ObjTestDetails.Other_Test_done ? ObjTestDetails.Other_Test_done : '-'}}</div>
        </div>
        <div class="col-sm-4" *ngIf="ObjTestDetails.Other_Test_Details">
            <label class="control-label">Others Details</label>
            <div class="label-t">{{ObjTestDetails.Other_Test_Details ? ObjTestDetails.Other_Test_Details : '-'}}</div>
        </div>
    </div>
    <p-footer>
      <button class="btn btn-primary" (click)="closedisplayViewTestPOP()" >
        <span class="glyphicon glyphicon-remove"></span>Close
      </button>
    </p-footer>
</p-dialog>

<!-- View case history dialog -->
<p-dialog
[header]="'Case History'"
[appendTo]="'body'"
[visible]="displayViewCaseHistory"
[closeOnEscape]="true"
[closable]="false"
[modal]="true"
[responsive]="true"
[style]="{ width: '90%', minWidth: '200px', minHeight: '400px' }"
style="text-align: center;"
[minY]="70"
[maximizable]="true"
[baseZIndex]="10000"
[autoZIndex]="true"
>
    <div class="form-group" >
        <div class="col-sm-3" style="margin-bottom: 20px;">
            <label class="control-label">Date</label>
            <div class="label-t">{{ObjCaseHistory.Registration_Date ? (ObjCaseHistory.Registration_Date|date:'dd/MMM/yyyy'):"-"}}</div>
        </div>
    </div>
    <br>
    <div class="row">
    <div class="col-sm-12">
        <div class="panel-group">
            <div class="panel panel-primary">
                    <div class="panel-body">
                        <div class="form-group" style="padding: 1em;">
                        <h4 style="padding: 0.5em 0em; margin-top:-26px; color: #007ca3;">
                            <strong>PATIENT INFORMATION</strong>
                        </h4>
                            <div class="row">
                                <div class="col-sm-4">
                                    <label class="control-label">Mobile No<sup class="text-danger">*</sup></label>
                                    
                                    <div class="label-t">{{ObjCaseHistory.Mobile ? ObjCaseHistory.Mobile :"-"}}</div>
                                </div>
                                <div class="col-sm-4">
                                    <label class="control-label">Alternate Mobile No</label>
                                    <div class="label-t">{{ObjCaseHistory.Mobile_2 ? ObjCaseHistory.Mobile_2 :"-"}}</div>
                                </div>
                                <div class="col-sm-4">
                                    <label class="control-label">WhatsApp No</label>
                                     <div class="label-t">{{ObjCaseHistory.Mobile_3_WP ? ObjCaseHistory.Mobile_3_WP :"-"}}</div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-4">
                                    <label class="control-label">Name<sup class="text-danger">*</sup> </label>
                                    <div class="label-t">{{ObjCaseHistory.Patient_Name ? ObjCaseHistory.Patient_Name :"-"}}</div>
                                   
                                    
                                </div>
                                <div class="col-sm-4">
                                    <label class="control-label">Age</label>
                                    <div class="label-t">{{ObjCaseHistory.Age ? ObjCaseHistory.Age :"-"}}</div>
                                </div>
                                <div class="col-sm-4">
                                    <label class="control-label">Gender<sup class="text-danger">*</sup></label>
                                    <div class="label-t">{{ObjCaseHistory.Gender ? ObjCaseHistory.Gender :"-"}}</div>
                                </div>
                                </div>
                        <div class="row">
                            <div class="col-sm-4">
                                <label class="control-label">Date of Birth </label>
                                <div class="label-t">{{ObjCaseHistory.Date_Of_Birth ? (ObjCaseHistory.Date_Of_Birth | date:'dd/MMM/yyyy'):"-"}}</div>
                            </div>
                            <div class="col-sm-4">
                                <label class="control-label">Email ID</label>
                                <div class="label-t">{{ObjCaseHistory.Email ? ObjCaseHistory.Email :"-"}}</div>
                            </div>
                            <div class="col-sm-4">
                                <label class="control-label">Profession<sup class="text-danger"></sup></label>
                                <div class="label-t">{{ObjCaseHistory.Occupation ? ObjCaseHistory.Occupation :"-"}}</div>
                                </div>
                        </div>
                        <div class="row">
                            <div class="col-sm-4">
                                <label class="control-label">Pincode</label>
                                    <div class="label-t">{{ObjCaseHistory.Pin ? ObjCaseHistory.Pin :"-"}}</div>
                            </div>
                            <div class="col-sm-4">
                                <label class="control-label">Location</label>
                                <div class="label-t">{{ObjCaseHistory.Location ? ObjCaseHistory.Location :"-"}}</div>
                            </div>
                            <div class="col-sm-4">
                                <label class="control-label">Country</label>
                                <div class="label-t">{{ObjCaseHistory.Country ? ObjCaseHistory.Country :"-"}}</div>
                            </div>
                            </div>
                            <div class="row">
                            <div class="col-sm-4">
                                <label class="control-label">State</label>
                                <div class="label-t">{{ObjCaseHistory.State ? ObjCaseHistory.State :"-"}}</div>
                            </div>
                            <div class="col-sm-4">
                                <label class="control-label">District</label>
                                <div class="label-t">{{ObjCaseHistory.District ? ObjCaseHistory.District :"-"}}</div>
                            </div>
                            <div class="col-sm-4">
                                <label class="control-label">Address</label>
                                <div class="label-t">{{ObjCaseHistory.Address ? ObjCaseHistory.Address :"-"}}</div>
                            </div>
                            </div>
                            <div class="row">
                            <div class="col-sm-4">
                                <label class="control-label">Enquiry Source<sup class="text-danger">*</sup></label>
                                <div class="label-t">{{ObjCaseHistory.Enq_Source_Name ? ObjCaseHistory.Enq_Source_Name :"-"}}</div>
                            </div>
                            <div class="col-sm-4">
                                <label class="control-label">Reference Doctor</label>
                                <div class="label-t">{{ObjCaseHistory.Enq_Source_Sub_Name ? ObjCaseHistory.Enq_Source_Sub_Name :"-"}}</div>
                              </div>
                            <div class="col-sm-4">
                                <label class="control-label">Consultancy Type<sup class="text-danger">*</sup></label>
                                <div class="label-t">{{ObjCaseHistory.Consultancy_Type ? ObjCaseHistory.Consultancy_Type :"-"}}</div>
                            </div>
                            </div>
                            <div class="row">
                            <div class="col-sm-4">
                                <label class="control-label">Who has accompanied you<sup class="text-danger"></sup></label>
                                <div class="label-t">{{ObjCaseHistory.Who_has_accompanied_you ? ObjCaseHistory.Who_has_accompanied_you :"-"}}</div>
                            </div>
                            </div>
                        </div>
                    </div>
            </div>
        </div>
    </div>
    </div>
    <br>
     <div class="row" style="padding: 1em;">
        <h5 style="
        padding: 0.5em 1em;
        background: #c1c1c185;
        border-top: 5px solid #3c8dbc;
        border-bottom: 1px solid #c6c6c6;
        margin-top: -20px;
        ">
        <i class="fa fa-user">
        </i> &nbsp;<strong>Case History:</strong>
        </h5>
    </div>
    
    <div class="form-group">
        <div class="col-sm-3">
            <label class="control-label">Reason for Visit<sup class="text-danger"></sup></label>
            <div class="label-t">{{ObjCaseHistory.Reason_for_Visit? ObjCaseHistory.Reason_for_Visit :"-"}}</div>
        </div>
        <div class="col-sm-3">
            <label class="control-label">Present complain<sup class="text-danger"></sup></label>
            <div class="label-t">{{ObjCaseHistory.Present_complain? ObjCaseHistory.Present_complain :"-"}}</div>
        </div>
        <div class="col-sm-3">
            <label class="control-label">Right Ear Tinnitus<sup class="text-danger"></sup></label>
            <div class="label-t">{{ObjCaseHistory.Right_ear_tinnitus? ObjCaseHistory.Right_ear_tinnitus :"-"}}</div>
        </div>
        <div class="col-sm-3">
            <label class="control-label">Left Ear Tinnitus<sup class="text-danger"></sup></label>
            <div class="label-t">{{ObjCaseHistory.Left_ear_tinnitus? ObjCaseHistory.Left_ear_tinnitus :"-"}}</div>
        </div>
    </div>
    <div class="form-group">
        <div class="col-sm-3">
            <label class="control-label">Right Ear Pain<sup class="text-danger"></sup></label>
            <div class="label-t">{{ObjCaseHistory.Right_ear_pain? ObjCaseHistory.Right_ear_pain :"-"}}</div>
        </div>
        <div class="col-sm-3">
            <label class="control-label">Left Ear Pain<sup class="text-danger"></sup></label>
            <div class="label-t">{{ObjCaseHistory.Left_ear_pain? ObjCaseHistory.Left_ear_pain :"-"}}</div>
        </div>
        <div class="col-sm-3">
            <label class="control-label">Right Ear Discharge<sup class="text-danger"></sup></label>
            <div class="label-t">{{ObjCaseHistory.Right_ear_discharge? ObjCaseHistory.Right_ear_discharge :"-"}}</div>
        </div>
        <div class="col-sm-3">
            <label class="control-label">Left Ear Discharge<sup class="text-danger"></sup></label>
            <div class="label-t">{{ObjCaseHistory.Left_ear_discharge? ObjCaseHistory.Left_ear_discharge :"-"}}</div>
        </div>
    </div>
    <div class="form-group">
        <div class="col-sm-3">
            <label class="control-label">Right Ear Vertigo/Dizziness <sup class="text-danger"></sup></label>
            <div class="label-t">{{ObjCaseHistory.Right_ear_Vertigo? ObjCaseHistory.Right_ear_Vertigo :"-"}}</div>
        </div>
        <div class="col-sm-3">
            <label class="control-label">Left Ear Vertigo/Dizziness <sup class="text-danger"></sup></label>
            <div class="label-t">{{ObjCaseHistory.Left_ear_Vertigo? ObjCaseHistory.Left_ear_Vertigo :"-"}}</div>
        </div>
        <div class="col-sm-3">
            <label class="control-label">Right Ear Blocking sensation <sup class="text-danger"></sup></label>
            <div class="label-t">{{ObjCaseHistory.Right_ear_blocking_sensation? ObjCaseHistory.Right_ear_blocking_sensation :"-"}}</div>
        </div>
        <div class="col-sm-3">
            <label class="control-label">Left Ear Blocking sensation <sup class="text-danger"></sup></label>
            <div class="label-t">{{ObjCaseHistory.Left_ear_blocking_sensation? ObjCaseHistory.Left_ear_blocking_sensation :"-"}}</div>
        </div>
    </div>
    <div class="form-group">
        <div class="col-sm-3">
            <label class="control-label">Exposure to noise <sup class="text-danger"></sup></label>
            <div class="label-t">{{ObjCaseHistory.Exposure_to_noise? ObjCaseHistory.Exposure_to_noise :"-"}}</div>
        </div>
        <div class="col-sm-4">
            <label class="control-label">Duration of noise exposure in a day (hours) <sup class="text-danger"></sup></label>
            <div class="label-t">{{ObjCaseHistory.Duration_of_noise_exposure? ObjCaseHistory.Duration_of_noise_exposure :"-"}}</div>
        </div>
    </div>
    <br>
    <div class="row" style="padding: 1em;">
        <h5 style="
        padding: 0.5em 1em;
        background: #c1c1c185;
        border-top: 5px solid #3c8dbc;
        border-bottom: 1px solid #c6c6c6;
        margin-top: 220px;
        ">
        <i class="fa fa-user">
        </i> &nbsp;<strong>Medical :</strong>
        </h5>
    </div>
    <div class="row">
        <div class="col-sm-3">
            <label class="control-label">Referring doctor/ENT <sup class="text-danger"></sup></label>
            <div class="label-t">{{ObjCaseHistory.Ref_doctor? ObjCaseHistory.Ref_doctor :"-"}}</div>
        </div>
        <div class="col-sm-3">
            <label class="control-label">Ear surgical history <sup class="text-danger"></sup></label>
            <div class="label-t">{{ObjCaseHistory.Surgical_history? ObjCaseHistory.Surgical_history :"-"}}</div>
        </div>
    </div>
    <br>
    <div class="row" style="padding: 1em;">
        <h5 style="
        padding: 0.5em 1em;
        background: #c1c1c185;
        border-top: 5px solid #3c8dbc;
        border-bottom: 1px solid #c6c6c6;
        margin-top: 0px;
        ">
        <i class="fa fa-user">
        </i> &nbsp;<strong>Hearing :</strong>
    </h5>
    </div>
    
    <div class="row">
        <div class="col-sm-3">
            <label class="control-label">Better ear <sup class="text-danger"></sup></label>
            <div class="label-t">{{ObjCaseHistory.Better_ear? ObjCaseHistory.Better_ear :"-"}}</div>
        </div>
        <div class="col-sm-3">
            <label class="control-label">Family history of hearing loss <sup class="text-danger"></sup></label>
            <div class="label-t">{{ObjCaseHistory.Family_history_of_hearing_loss? ObjCaseHistory.Family_history_of_hearing_loss :"-"}}</div>
        </div>
        <div class="col-sm-3">
            <label class="control-label">Current/previous hearing aid technology <sup class="text-danger"></sup></label>
            <div class="label-t">{{ObjCaseHistory.Pre_hearing_aid_technology? ObjCaseHistory.Pre_hearing_aid_technology :"-"}}</div>
        </div>
        <div class="col-sm-3">
            <label class="control-label">Current/previous hearing aid type <sup class="text-danger"></sup></label>
            <div class="label-t">{{ObjCaseHistory.Pre_hearing_aid_type? ObjCaseHistory.Pre_hearing_aid_type :"-"}}</div>
        </div>
    </div>
    <div class="row">
        <div class="col-sm-4">
            <label class="control-label">Hearing aid difficulties <sup class="text-danger"></sup></label>
            <div class="label-t">{{ObjCaseHistory.Hearing_aid_difficulties? ObjCaseHistory.Hearing_aid_difficulties :"-"}}</div>
        </div>
        <div class="col-sm-4">
            <label class="control-label">Date</label>
            <div class="label-t">{{ObjCaseHistory.Case_Date? (ObjCaseHistory.Case_Date | date:'dd/MMM/yyyy') :"-"}}</div>
            </div>
            <div class="col-sm-4" >
                <label class="control-label">Audilogist</label>
                <div class="label-t">{{ObjCaseHistory.Audiologist_Name? (ObjCaseHistory.Audiologist_Name) :"-"}}</div>                          
            </div>
    </div>
    
                  
<p-footer>
    <button class="btn btn-primary" (click)="closeCaseHistory()" >
      <span class="glyphicon glyphicon-remove"></span>Close
    </button>
  </p-footer>
</p-dialog>