<p-toast key="compacct-toast" baseZIndex="99999"> </p-toast>
<p-toast
  position="center"
  key="c"
  (onClose)="onReject()"
  [modal]="true"
  [autoZIndex]="true"
>
  <ng-template let-message pTemplate="message">
    <div style="text-align: center">
      <i class="pi pi-exclamation-triangle" style="font-size: 3em"></i>
      <h3>{{ message.summary }}</h3>
      <p>{{ message.detail }}</p>
    </div>

    <div class="ui-g ui-fluid">
      <div class="ui-g-6">
        <button
          type="button"
          pButton
          (click)="onConfirm()"
          label="Yes"
          class="ui-button-success"
        ></button>
      </div>
      <div class="ui-g-6">
        <button
          type="button"
          pButton
          (click)="onReject()"
          label="No"
          class="ui-button-secondary"
        ></button>
      </div>
    </div>
  </ng-template>
</p-toast>

<div class="row">
  <div class="col-xs-12">
    <div class="box box-primary">
      <div class="form-horizontal">
        <div class="box-body">
            <p-tabView [activeIndex]="tabIndexToView" (onChange)="TabClick($event)">
                <p-tabPanel headerStyleClass="compacct-tabs" [header]="items[0]" leftIcon="glyphicon glyphicon-list-alt">
                    <form name="SearchForm" #SearchForm="ngForm" novalidate>
                        <div class="form-group">
                            <div class="col-sm-3">
                                <label class="control-label">Date</label>
                                 <app-compacct-daterangepicker (DaterangeObj)="getDateRange($event)" [HardCodeDateOpt]="initDate"> <!-- [minmaxValid]= "initDateValid" required -->
                                </app-compacct-daterangepicker>
                            </div>
                            <div class="col-sm-3">
                                <label class="control-label">CostCenter Name</label>
                                <select class="form-control" name="browsecostcenter" #browsecostcenter="ngModel" [(ngModel)]="ObjBrowseSearch.Cost_Cen_ID" 
                                     [ngClass]="{'clearance': SearchSaleBillNewFormSubmitted && browsecostcenter?.errors?.required}" >
                                      <option  [ngValue]="undefined">Select</option>
                                      <option  *ngFor="let option of CostCenterList" value="{{option.Cost_Cen_ID}}">
                                        {{option.Cost_Cen_Name}}
                                      </option>
                                </select>
                            </div>
                            <div class="col-sm-2">
                                <div class="col-sm-3">
                                    <button class="btn btn-primary custombutton" data-toggle="modal" (click)="getSerarch(SearchForm.form.valid)" id="load" [disabled]="seachSpinner">
                                  <p-progressSpinner *ngIf="seachSpinner" [style]="{width: '15px', height: '15px'}" strokeWidth="8"  animationDuration=".5s"></p-progressSpinner>
                                  <span *ngIf="!seachSpinner" class="glyphicon glyphicon-search"></span>&nbsp;Search
                               </button>
                                </div>
                            </div>
                        </div>
                    </form>
                    <div class="no-padding">
                        <p-table #dt [value]="getAllDataList" 
                        [globalFilterFields]="getAllDataListHeaders" 
                        [paginator]="getAllDataList.length ? true:false" 
                        [rows]="10" [rowHover]="true" [autoLayout]="true"
                        sortMode="multiple"
                        [rowsPerPageOptions]="[10,20,30]"
                        [rowHover]="true">
                            <ng-template pTemplate="caption">
                                <div class="row">
                                    <div class="col-sm-3 pull-right" style="text-align: right;">
                                        <input type="text" pInputText size="50" placeholder="Search" (input)="dt.filterGlobal($event.target.value, 'contains')" class="searchInput form-control">
                                    </div>
                                </div>

                            </ng-template>
                            <ng-template pTemplate="header">
                                <tr>
                                    <th style="width:5em">Action</th>
                                    <th>Doc No</th>
                                    <th>Doc Date</th>
                                    <th>SubLedger</th>
                                    <th>CostCenter</th>
                                    <th>Net Amount</th>
                                    <th>Supplier Bill No</th>
                                    <th>Supplier Bill Date</th>
                                </tr>
                            </ng-template>
                            <ng-template pTemplate="body" let-col>
                                <tr>

                                    <td>
                                        <div class="dropdown">
                                            <button class="btn btn-default btn-sm tableButton dropdown-toggle" type="button" data-toggle="dropdown" style="height:27px">
                                                                        <i class="fa fa-fw fa-bars"></i>
                                                                        <span class="caret"></span>
                                                                    </button>
                                            <ul class="dropdown-menu">
                                          
                                                <li *ngIf="Permission === 'Y'">
                                                    <a (click)="purchaseBillDelete(col.Doc_No)">
                                                        <i class="fa fa-fw fa-trash"></i> Delete
                                                    </a>
                                                </li>
                                                <li >
                                                    <a (click)="PdfGenerate(col.Doc_No)">
                                                        <i class="fa fa-fw fa-file-pdf-o"></i> PDF
                                                    </a>
                                                </li>
                                            </ul>
                                        </div>
                                    </td>
                                    <td>{{col.Doc_No}}</td>
                                    <td>{{col.Doc_Date | date:'dd/MM/yyyy'}}</td>
                                    <td>{{col.Sub_Ledger_Name}}</td>
                                    <td>{{col.Cost_Cen_Name}}</td>
                                    <td>{{col.Net_Amt}}</td>
                                    <td>{{col.Supplier_Bill_No}}</td>
                                    <td>{{col.Supplier_Bill_Date}}</td>



                                </tr>
                            </ng-template>
                            <ng-template pTemplate="paginatorright" let-state>
                                Showing {{state.first+1}} of {{(state.first+1) + state.rows}} of {{state.totalRecords}}
                            </ng-template>
                        </p-table>
                    </div>
                </p-tabPanel>
                <p-tabPanel headerStyleClass="compacct-tabs" [header]="items[1]" leftIcon="glyphicon glyphicon-floppy-save">
                    <form name="putchaseBillCumgrnForm" #putchaseBillCumgrnForm="ngForm" novalidate>
                        <h5><strong>Vendor Details</strong></h5>
                        <div class="form-group">
                            <div class="col-sm-6">
                                <label>Vendor<span class="text-danger">*</span></label>
                                <p-dropdown [options]="SubLedgerList" name="vendor" 
                                [(ngModel)]="ObjSubLedger.Sub_Ledger_ID" 
                                [showClear]="true" 
                                [emptyFilterMessage]="' No Vendor Found'" 
                                (onChange)="SubledgerChange(ObjSubLedger.Sub_Ledger_ID)"
                                [filter]="true" 
                                filterBy="label,value.name" 
                                [resetFilterOnHide]="true" 
                                [placeholder]="'Select Vendor'"
                                [virtualScroll]="true" 
                                itemSize="30"
                                #vendor="ngModel" 
                                [required]="true"
                                [ngClass]="{'clearance':putchaseBillCumgrnFormSubmitted && vendor?.errors?.required}" 
                                required
                                 [disabled]="false" >
                                </p-dropdown>
                            </div>
                            <div class="col-sm-3">
                                <label class="control-label">Billing Name </label>
                                <input class="form-control" 
                                 name="billingname" 
                                 #billingname="ngModel"
                                 [(ngModel)]="ObjSubLedger.Sub_Ledger_Billing_Name" 
                                 placeholder="Billing Name" 
                                 [disabled]="true" 
                                 [ngClass]="{'clearance':putchaseBillCumgrnFormSubmitted && billingname?.errors?.required}" >
                            </div>
                            <div class="col-sm-3">
                                <label class="control-label">Choose Address<sup class="text-danger">*</sup></label>
                                <select class="form-control"
                                 name="chooseaddress"
                                 #chooseaddress="ngModel" 
                                 [(ngModel)]="ObjSubLedger.address_caption"
                                 (change)="ChangeSubLedgerAddress(ObjSubLedger.address_caption)"
                                  [ngClass]="{'clearance': putchaseBillCumgrnFormSubmitted && chooseaddress?.errors?.required}"
                                   required>
                                      <option  [ngValue]="undefined">Select</option>
                                      <option *ngFor="let option of SubLedgerAddressLists" value="{{option.Address_Caption}}"  >{{option.Address_Caption}}</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="col-sm-3">
                                <label class="control-label">State<span class="text-danger">*</span></label>
                                <select class="form-control"
                                         name="subledgerstate"
                                         #subledgerstate="ngModel" 
                                        [(ngModel)]="ObjSubLedger.Sub_Ledger_State"
                                        [ngClass]="{'clearance': putchaseBillCumgrnFormSubmitted && subledgerstate?.errors?.required}"
                                        required
                                        [disabled]="true">
                                        <option  [ngValue]="undefined">Select</option>
                                    <option *ngFor="let option of states" value="{{option.State}}">{{option.State}}</option>
                                </select>
                            </div>
                            <div class="col-sm-3">
                                <label class="control-label" >GST No</label>
                                <input type="text"   
                                        class="form-control"
                                        name="SubLedgerGSTNo"
                                        #SubLedgerGSTNo="ngModel" 
                                        [(ngModel)]="ObjSubLedger.Sub_Ledger_GST_No"
                                        [ngClass]="{'clearance': putchaseBillCumgrnFormSubmitted && SubLedgerGSTNo?.errors?.required}"
                                        required
                                        [disabled]="true">
                            </div>
                            <div class="col-sm-3">
                                <label class="control-label">Address<span class="text-danger"></span></label>
                                <input type="text"   
                                class="form-control"
                                name="SubLedgerAddress1"
                                #SubLedgerAddress1="ngModel" 
                                [(ngModel)]="ObjSubLedger.Sub_Ledger_Address_1"
                                [ngClass]="{'clearance': putchaseBillCumgrnFormSubmitted && SubLedgerAddress1?.errors?.required}"
                                required
                                [disabled]="true">
                            </div>
                            <div class="col-sm-3">
                                <label class="control-label">Land Mark<span class="text-danger"></span></label>
                                <input type="text"   
                                class="form-control"
                                name="SubLedgerLandMark"
                                #SubLedgerLandMark="ngModel" 
                                [(ngModel)]="ObjSubLedger.Sub_Ledger_Land_Mark"
                                [ngClass]="{'clearance': putchaseBillCumgrnFormSubmitted && SubLedgerLandMark?.errors?.required}"
                                required
                                [disabled]="true">
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="col-sm-3">
                                <label class="control-label">PIN</label>
                                <input class="form-control" 
                                name="pin" 
                                #pin="ngModel" 
                                [(ngModel)]="ObjSubLedger.Sub_Ledger_Pin"
                                [ngClass]="{'clearance': putchaseBillCumgrnFormSubmitted && pin?.errors?.required}"
                                [disabled]="true"
                                placeholder="PIN" />
                            </div>
                            <div  class="col-sm-3">
                                <label class="control-label">District</label>
                                <input class="form-control" 
                                type="text"  
                                name="District"
                                #District="ngModel" 
                                [(ngModel)]="ObjSubLedger.Sub_Ledger_District"
                                [ngClass]="{'clearance': putchaseBillCumgrnFormSubmitted && District?.errors?.required}"
                                [disabled]="true"
                                placeholder="District">
                            </div>
                            <div  class="col-sm-3">
                                <label class="control-label">Country</label>
                                <input class="form-control" 
                                type="text" 
                                name="Country"
                                #Country="ngModel" 
                                [(ngModel)]="ObjSubLedger.Sub_Ledger_Country"
                                [ngClass]="{'clearance': putchaseBillCumgrnFormSubmitted && Country?.errors?.required}"
                                [disabled]="true"
                                placeholder="Country">
                            </div>
                            <div  class="col-sm-3">
                                <label class="control-label">Email</label>
                                <input class="form-control" 
                                name="email" 
                                type="text" 
                                #email="ngModel" 
                                [(ngModel)]="ObjSubLedger.Sub_Ledger_Email"
                                [ngClass]="{'clearance': putchaseBillCumgrnFormSubmitted && email?.errors?.required}"
                                [disabled]="true"
                                placeholder="Email" 
                               />
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="col-sm-3">
                                <label class="control-label">Contact No</label>
                                <input class="form-control" 
                                name="Mobile" 
                                #Mobile="ngModel" 
                                [(ngModel)]="ObjSubLedger.Sub_Ledger_Mobile_No"
                                [ngClass]="{'clearance': putchaseBillCumgrnFormSubmitted && Mobile?.errors?.required}"
                                [disabled]="true"
                                placeholder="Mobile" />
                            </div>
                            <div  class="col-sm-3">
                                <label class="control-label">PAN No</label>
                                <input class="form-control" 
                                type="text"  
                                name="PAN"
                                #PAN="ngModel" 
                                [(ngModel)]="ObjSubLedger.Sub_Ledger_PAN_No"
                                [ngClass]="{'clearance': putchaseBillCumgrnFormSubmitted && PAN?.errors?.required}"
                                [disabled]="true"
                                placeholder="PAN No">
                            </div>
                            <div  class="col-sm-3">
                                <label class="control-label">CIN</label>
                                <input class="form-control" 
                                type="text" 
                                name="CIN"
                                #CIN="ngModel" 
                                [(ngModel)]="ObjSubLedger.Sub_Ledger_UID_NO"
                                [ngClass]="{'clearance': putchaseBillCumgrnFormSubmitted && CIN?.errors?.required}"
                                [disabled]="true"
                                placeholder="CIN">
                            </div>
                        </div>
                        <hr class="box boxboxDivide-primary" />
                        <h5><strong> Bill to CostCente </strong></h5>
                        <div class="form-group">
                            <div class="col-sm-3">
                                <label>CostCenter<span class="text-danger">*</span></label>
                                <select class="form-control" 
                                        name="CostCentTrn"
                                        #CostCentTrn="ngModel" 
                                        [(ngModel)]="ObjCostCenter.Cost_Cen_ID"
                                        (change)="CostCenterChange(ObjCostCenter.Cost_Cen_ID)"
                                        [ngClass]="{'clearance': putchaseBillCumgrnFormSubmitted && CostCentTrn?.errors?.required}"
                                        required>
                                        <option *ngFor=" let option of CostCenterList " value="{{option.Cost_Cen_ID}}" >
                                            {{option.Cost_Cen_Name}}
                                        </option>
                                    </select>
                            </div>
                            <div class="col-sm-3">
                                <label class="control-label">Address</label>
                                <input class="form-control" 
                                 name="address1" 
                                 #address1="ngModel"
                                 [(ngModel)]="ObjCostCenter.Cost_Cen_Address1" 
                                 [disabled]="true" 
                                 [ngClass]="{'clearance':putchaseBillCumgrnFormSubmitted && address1?.errors?.required}" >
                            </div>
                            <div class="col-sm-3">
                                <label class="control-label">Address</label>
                                <input class="form-control" 
                                 name="address2" 
                                 #address2="ngModel"
                                 [(ngModel)]="ObjCostCenter.Cost_Cen_Address2" 
                                 [disabled]="true" 
                                 [ngClass]="{'clearance':putchaseBillCumgrnFormSubmitted && address2?.errors?.required}" >
                            </div>
                            <div class="col-sm-3">
                                <label class="control-label">State</label>
                                <input class="form-control" 
                                 name="CostCenState" 
                                 #CostCenState="ngModel"
                                 [(ngModel)]="ObjCostCenter.Cost_Cen_State" 
                                 [disabled]="true" 
                                 [ngClass]="{'clearance':putchaseBillCumgrnFormSubmitted && CostCenState?.errors?.required}" >
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="col-sm-3">
                                <label class="control-label">GST No</label>
                                <input class="form-control" 
                                 name="CostCenGSTNo" 
                                 #CostCenGSTNo="ngModel"
                                 [(ngModel)]="ObjCostCenter.Cost_Cen_GST_No" 
                                 [disabled]="true" 
                                 placeholder="GST No" >
                            </div>
                            <div  class="col-sm-3">
                                <label class="control-label">Location</label>
                                <input class="form-control" 
                                 name="CostCenLocation"
                                 #CostCenLocation="ngModel" 
                                 [(ngModel)]="ObjCostCenter.Cost_Cen_Location"
                                 placeholder="Location"
                                 [disabled]="true" >
                            </div>
                            <div  class="col-sm-3">
                                <label class="control-label">PIN</label>
                                <input class="form-control" 
                                 name="CostCenPIN"
                                 #CostCenPIN="ngModel" 
                                 [(ngModel)]="ObjCostCenter.Cost_Cen_PIN" 
                                 [disabled]="true"
                                 placeholder="PIN"  >
                            </div>
                            <div  class="col-sm-3">
                                <label class="control-label">District</label>
                                <input class="form-control" 
                                 name="CostCenDistrict"
                                 #CostCenDistrict="ngModel" 
                                 [(ngModel)]="ObjCostCenter.Cost_Cen_District" 
                                 [disabled]="true"
                                 placeholder="District"  >
                            </div>
                        </div>

                        <div class="form-group">
                            <div class="col-sm-3">
                                <label class="control-label">Country</label>
                                <input class="form-control" 
                                 name="CostCenCountry" 
                                 #CostCenCountry="ngModel"
                                 [(ngModel)]="ObjCostCenter.Cost_Cen_Country" 
                                 [disabled]="true" 
                                 placeholder="Country" >
                            </div>
                            <div  class="col-sm-3">
                                <label class="control-label">Mobile</label>
                                <input class="form-control" 
                                 name="CostCenMobile"
                                 #CostCenMobile="ngModel" 
                                 [(ngModel)]="ObjCostCenter.Cost_Cen_Mobile"
                                 placeholder="Mobile"
                                 [disabled]="true" >
                            </div>
                            <div  class="col-sm-3">
                                <label class="control-label">Phone</label>
                                <input class="form-control" 
                                 name="CostCenPhone"
                                 #CostCenPhone="ngModel" 
                                 [(ngModel)]="ObjCostCenter.Cost_Cen_Phone" 
                                 [disabled]="true"
                                 placeholder="Phone"  >
                            </div>
                            <div  class="col-sm-3">
                                <label class="control-label">Email</label>
                                <input class="form-control" 
                                 name="CostCenEmail"
                                 #CostCenEmail="ngModel" 
                                 [(ngModel)]="ObjCostCenter.Cost_Cen_Email1" 
                                 [disabled]="true"
                                 placeholder="Email"  >
                            </div>
                        </div>
                        <hr class="box boxboxDivide-primary" />
                        <div class="form-group">
                            <div class="col-sm-3">
                                <label>	Doc. Date<sup class="text-danger">*</sup></label>
                                <div class="input-group date">
                                    <div class="input-group-addon">
                                     <i class="fa fa-calendar"></i>
                                </div>
                                <ejs-datepicker [format]="'dd/MMM/yyyy'" [(value)]='DocDate'></ejs-datepicker>
                                </div>
                            </div>
                            <div class="col-sm-3">
                                <label>	Project<sup class="text-danger"></sup></label>
                                <select class="form-control"
                                name="project"
                                #project="ngModel" 
                               [(ngModel)]="ObjOther.Project_ID"
                              >
                              <option  [ngValue]="undefined">Select</option>
                             <option *ngFor="let option of ProjectList" [ngValue]="option.Project_ID">{{option.Project_Name}}</option>
                       </select>
                            </div>
                            <div class="col-sm-3">
                                <label>	CN No<sup class="text-danger"></sup></label>  
                                <input class="form-control" 
                                 name="CNNo" 
                                 #CNNo="ngModel"
                                 [(ngModel)]="ObjOther.CN_No" 
                                 placeholder="CN No"
                                  >
                            </div>
                            <div class="col-sm-3">
                                <label>	CN Date<sup class="text-danger">*</sup></label>
                                <div class="input-group date">
                                    <div class="input-group-addon">
                                     <i class="fa fa-calendar"></i>
                                </div>
                                <ejs-datepicker [format]="'dd/MMM/yyyy'" [(value)]='cnnDate'></ejs-datepicker>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="col-sm-3">
                                <label>Currency<sup class="text-danger"></sup></label>
                                <select class="form-control"
                                name="Currency"
                                #Currency="ngModel" 
                               [(ngModel)]="ObjOther.Currency_ID"
                               >
                               <option  [ngValue]="undefined">Select</option>
                                 <option *ngFor="let option of CurrencyList" value="{{option.Currency_ID}}">{{option.Currency_Symbol}}</option>
                                </select>
                            </div>
                            <div class="col-sm-3">
                                <label>Revenue Cost Center<span class="text-danger">*</span></label>
                                <select class="form-control" 
                                        name="VoucherCommonCostCentTrn"
                                        #VoucherCommonCostCentTrn="ngModel" 
                                        [(ngModel)]="ObjVoucherCommon.Cost_Cen_ID_Trn"
                                        [ngClass]="{'clearance': putchaseBillCumgrnFormSubmitted && VoucherCommonCostCentTrn?.errors?.required}"
                                        required>
                                        <option  [ngValue]="undefined">Select</option>
                                        <option *ngFor="let option of CostCenterList"  [ngValue]="option.Cost_Cen_ID"  >
                                            {{option.Cost_Cen_Name}}
                                        </option>
                                    </select>
                            </div>
                            <div class="col-sm-3">
                                <label>Supplier Bill No<sup class="text-danger"></sup></label>  
                                <input class="form-control" 
                                 name="SupplierBillNo" 
                                 #SupplierBillNo="ngModel"
                                 [(ngModel)]="ObjPurchaseBill.Supplier_Bill_No" 
                                 placeholder="Supplier Bill No"
                                  >
                            </div>
                            <div class="col-sm-3">
                                <label>Supplier Bill Date<sup class="text-danger">*</sup></label>
                                <div class="input-group date">
                                    <div class="input-group-addon">
                                     <i class="fa fa-calendar"></i>
                                </div>
                                <ejs-datepicker [format]="'dd/MMM/yyyy'" [(value)]='SupplierBillDate'></ejs-datepicker>
                                </div>
                            </div>
                            <div class="col-sm-4">
                                <label> Remarks </label>
                                <textarea class="form-control" 
                                rows="2" 
                                name="Remarks"
                                #Remarks="ngModel"
                                [(ngModel)]="ObjPurchaseBill.Remarks" 
                                placeholder="Remarks"></textarea>
                            </div>
                        </div>
                        <hr class="box boxboxDivide-primary" />
                        <div class="form-group">
                            <div class="col-sm-4" >
                                <label> Ship to CostCenter<span class="text-danger">*</span></label>
                                <select class="form-control" 
                                        name="ShiptoCostCenter"
                                        #ShiptoCostCenter="ngModel" 
                                        [(ngModel)]="ShipCostCenter"
                                        (change)="ShipCostCenterChange()"
                                        >
                                        <option  [ngValue]="undefined">Select</option>
                                        <option *ngFor=" let option of CostCenterList " value="{{option.Cost_Cen_ID}}" >
                                            {{option.Cost_Cen_Name}}
                                        </option>
                                    </select>
                            </div>
                        </div>
                        <br>
                        <div class="table-responsive no-padding">
                            <table class="table table-bordered">
                                <thead style="background-color:#3c8dbc;color:white;">
                                    <tr>
                                        <th nowrap  class="text-center" style="vertical-align:middle">Sl.No.</th>
                                        <th nowrap  class="text-center" style="vertical-align:middle">Check</th>
                                        <th nowrap  class="text-center" style="vertical-align:middle">CN/Challan No</th>
                                        <th nowrap  class="text-center" style="vertical-align:middle">CN/Challan Date</th>
                                        <th nowrap  class="text-center" style="vertical-align:middle">Doc No</th>
                                        <th nowrap  class="text-center" style="vertical-align:middle">Doc Date</th>
                                        <th nowrap  class="text-center" style="vertical-align:middle">Remarks</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr *ngFor="let obj of uniqueArray(purchaseChallanList) ; let ind = index;" >
                                        <td>{{ ind + 1 }}</td>
                                        <td>   
                                            <p-checkbox [(ngModel)]="obj.checked" 
                                            [name]="'check'+ind" 
                                            [binary]="true"
                                            (onChange)="CheckBoxChange(obj)"
                                            ></p-checkbox></td>
                                        <td>{{obj.CN_No ? obj.CN_No : ''}}</td>
                                        <td>{{obj.CN_Date ? (obj.CN_Date| date : 'dd/MMM/yyyy') : ''}}</td>
                                        <td>{{obj.Doc_No}}</td>
                                        <td>{{obj.Doc_Date | date : 'dd/MMM/yyyy'}}</td>
                                        <td>{{obj.Remarks ? obj.Remarks :''}}</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <br />
                        <!-- OtherInfo Table-->
                        <div class="table-responsive no-padding">
                          <table class="table table-bordered">
                            <colgroup span="2"></colgroup>
                            <colgroup span="2"></colgroup>
                            <colgroup span="2"></colgroup>
                            <thead>
                              <tr style="background-color:#3c8dbc;color:white">
                                <th nowrap rowspan="2" class="text-center" style="vertical-align:middle">Sl. No.</th>
                                <th nowrap rowspan="2" class="text-center" style="vertical-align:middle">Purchase Challan</th>
                                <th nowrap rowspan="2" class="text-center" style="vertical-align:middle">Product Details</th>
                                <th nowrap rowspan="2" class="text-center" style="vertical-align:middle">HSN No</th>
                                <th nowrap rowspan="2" class="text-center" style="vertical-align:middle">Batch No</th>
                                <th nowrap rowspan="2" class="text-center" style="vertical-align:middle">Serial No</th>
                                <th rowspan="2" class="text-center" style="vertical-align:middle">Qty.</th>
                                <th rowspan="2" class="text-center" style="vertical-align:middle">Unit</th>
                                <th rowspan="2" class="text-center" style="vertical-align:middle">Rate</th>
                                <th nowrap rowspan="2" class="text-center" style="vertical-align:middle">Tol. Amt</th>
                                <th nowrap rowspan="2" class="text-center" style="vertical-align:middle">Discount Type</th>
                                <th nowrap rowspan="2" class="text-center" style="vertical-align:middle">Discount</th>
                                <th nowrap rowspan="2" class="text-center" style="vertical-align:middle">Discount Amt</th>
                                <th nowrap rowspan="2" class="text-center" style="vertical-align:middle">Taxable Amt</th>
                                <th colspan="2" scope="colgroup" class="text-center">CGST</th>
                                <th colspan="2" scope="colgroup" class="text-center">SGST</th>
                                <th colspan="2" scope="colgroup" class="text-center">IGST</th>
                                <th nowrap rowspan="2" class="text-center" style="vertical-align:middle">Stock Point</th>
                              </tr>
                              <tr style="background-color:#3c8dbc;color:white">
                                <th scope="col" class="text-center">Rate</th>
                                <th scope="col" class="text-center">Amt.</th>
                                <th scope="col" class="text-center">Rate</th>
                                <th scope="col" class="text-center">Amt.</th>
                                <th scope="col" class="text-center">Rate</th>
                                <th scope="col" class="text-center">Amt.</th>
                              </tr>
                            </thead>
                            <tbody>
                              <tr *ngFor="let d of selectTableData(); let index = index" > 
                                <td>{{index+1}}</td>
                                <td>{{d.Doc_No}}</td>
                                <td>{{d.Product_Name}}</td>
                                <td>{{d.HSL_No}}</td>
                                <td>{{d.Batch_Number}}</td>
                                <td>{{d.Serial_No}}</td>
                     
                                <td>{{d.Qty}}</td>
                                <td nowrap>{{d.UOM}}</td>
                                <td><input class="form-control" 
                                    type="text"
                                    [name]="'Rate'+index"
                                     [(ngModel)]="d.Rate" 
                                     style="width: 108px;" 
                                     ></td>
                                <td>{{d.Amount}}</td>
                                <td>
                                  <select 
                                  [name]="'distype'+index"
                                          [(ngModel)]="d.Discount_Type" 
                                          class="form-control"
                                          >
                                    <option value="">Select</option>
                                    <option value="%"> %</option>
                                    <option value="AMT"> AMT</option>
                                  </select>
                                </td>
                                <td>
                                  <input class="form-control" [name]="'Discount'+index"
                                         [(ngModel)]="d.Discount" 
                                         placeholder="Discount"/>
                                </td>
                                <td>{{d.Discount_Type_Amount}}</td>
                                <td>{{d.Taxable_Amount}}</td>
                                <td>{{d.CGST_Rate}}</td>
                                <td>{{d.CGST_Amount}}</td>
                                <td>{{d.SGST_Rate}}</td>
                                <td>{{d.SGST_Amount}}</td>
                                <td>{{d.IGST_Rate}}</td>
                                <td>{{d.IGST_Amount}}</td>
                                <td nowrap>{{d.godown_name}}</td>
                              </tr>
                            </tbody>
                          </table>
                        </div>
                        <br />
                    </form>
                    <hr class="box boxboxDivide-primary" />
                    <form  name="termForm" #termForm="ngForm"  novalidate>
                        <div class="form-group">
                            <div class="col-sm-3">
                                <label>Term Name<sup class="text-danger">*</sup></label>
                                <select class="form-control"
                                name="TermName"
                                #TermName="ngModel" 
                                [(ngModel)]="ObjTerm.Term_ID"
                                [ngClass]="{'clearance': termFormSubmitted && TermName?.errors?.required}"
                                (change)="termChange(ObjTerm.Term_ID)"
                                required>
                                    <option  [ngValue]="undefined">Select</option>
                                    <option *ngFor="let option of termList" [ngValue]="option.Term_ID">{{option.Term_Name}}</option>
                                </select>
                            </div>
                            <div class="col-sm-2">
                                <label>HSN No<sup class="text-danger"></sup></label>  
                                <input class="form-control" 
                                 name="HSNNo" 
                                 #HSNNo="ngModel"
                                 [(ngModel)]="ObjTerm.HSN_No" 
                                 placeholder="HSN No"
                                 [ngClass]="{'clearance': termFormSubmitted && HSNNo?.errors?.required}"
                                 required
                                  >
                            </div>
                            <div class="col-sm-2">
                                <label>Term Amount<sup class="text-danger">*</sup></label>
                                <input class="form-control" 
                                name="termamount" 
                                #termamount="ngModel"
                                [(ngModel)]="ObjTerm.Term_Amount" 
                                placeholder="Amount"
                                [ngClass]="{'clearance': termFormSubmitted && termamount?.errors?.required}"
                                required
                                 >
                            </div>
                            <div class="col-sm-2">
                                <button type="submit" class="btn btn-primary" style="margin-top: 25px;margin-left: 15px; "
                                 (click)="addTerm(termForm.form.valid)" >
                                <span class="glyphicon glyphicon-plus"></span>Add
                            </button>
                            </div>
                        </div>
                        <br>
                        <div class="table-responsive no-padding">
                            <table class="table table-bordered">
                             <thead style="background-color:#3c8dbc;color:white;">
                                <tr style="background-color:#3c8dbc;color:white;">
                                  <th nowrap rowspan="2" class="text-center" style="vertical-align:middle">Sl. No.</th>
                                  <th nowrap rowspan="2" class="text-center" style="vertical-align:middle">Term Name</th>
                                  <th nowrap rowspan="2" class="text-center" style="vertical-align:middle">HSN No</th>
                                  <th nowrap rowspan="2" class="text-center" style="vertical-align:middle">Term Amount</th>
                                  <th colspan="2" scope="colgroup" class="text-center">CGST</th>
                                  <th colspan="2" scope="colgroup" class="text-center">SGST</th>
                                  <th colspan="2" scope="colgroup" class="text-center">IGST</th>
                                  <th rowspan="2" class="text-center" style="vertical-align:middle">Delete</th>
                                </tr>
                                <tr style="background-color:#3c8dbc;color:white">
                                   <th scope="col" class="text-center">Rate</th>
                                   <th scope="col" class="text-center">Amt.</th>
                                   <th scope="col" class="text-center">Rate</th>
                                   <th scope="col" class="text-center">Amt.</th>
                                   <th scope="col" class="text-center">Rate</th>
                                   <th scope="col" class="text-center">Amt.</th>
                                </tr>
                             </thead>
                            <tbody>
                                <tr *ngFor=" let col of TermTableLists; let ind = index;" >
                                  <td>{{ ind + 1  }}</td>
                                  <td>{{ col.Term_Name }}</td>
                                  <td>{{ col.HSN_No }}</td>
                                  <td>{{ col.Term_Amount }}</td>
                                  <td>{{ col.CGST_Rate }}</td>
                                  <td>{{ col.CGST_Amount }}</td>
                                  <td>{{ col.SGST_Rate }}</td>
                                  <td>{{ col.SGST_Amount }}</td>
                                  <td>{{ col.IGST_Rate }}</td>
                                  <td>{{ col.IGST_Amount }}</td>
                                  <td><button (click)="DeteteTerm(ind)" class="btn danger"><i class="fa fa-trash"></i></button></td>
                                </tr>
                            </tbody>
                           </table>
                        </div>
                    </form>
                    <div class="row">
                        <div class="col-xs-6">
                            <div class="table-responsive">
                                <table class="table">
                                    <tr>
                                        <th style="width:30%">Total Amount:</th>
                                        <td>{{ ObjPurchaseBill.Total_Amount}}</td>
                                    </tr>
                                    <tr>
                                        <th>Discount Amount:</th>
                                        <td>{{ObjPurchaseBill.Discount_Amount }}</td>
                                    </tr>
                                    <tr>
                                        <th>Taxable Amount:</th>
                                        <td>{{ObjPurchaseBill.Taxable_Amt }}</td>
                                    </tr>
                                    <tr>
                                        <th>Term Amount:</th>
                                        <td>{{ObjPurchaseBill.Term_Amt }}</td>
                                    </tr>
                                    <tr>
                                        <th>CGST Amount:</th>
                                        <td>{{ObjPurchaseBill.CGST_Amt }}</td>
                                    </tr>
                                    <tr>
                                        <th>SGST Amount:</th>
                                        <td>{{ ObjPurchaseBill.SGST_Amt }}</td>
                                    </tr>
                                    <tr>
                                        <th>IGST Amount:</th>
                                        <td>{{ ObjPurchaseBill.IGST_Amt  }}</td>
                                    </tr>
                                    <tr>
                                        <th>Gross Amount: </th>
                                        <td>{{ ObjPurchaseBill.Gross_Amt  }}</td>
                                    </tr>
                                    <tr>
                                        <th>Rounded Off:</th>
                                        <td>{{ ObjPurchaseBill.ROUNDED_OFF  }}</td>
                                    </tr>
                                    <tr>
                                        <th>Net Amount: </th>
                                        <td>{{ ObjPurchaseBill.Net_Amt  }}</td>
                                    </tr>
                                </table>
                            </div>
                        </div>
                        <div class="col-xs-6">
                            <div class="box-footer">
                                <button class="btn btn-primary pull-right" (click)="SavePurchaseBill(putchaseBillCumgrnForm.form.valid)" id="load" [disabled]="Spinner">
                                    <p-progressSpinner *ngIf="Spinner" [style]="{width: '15px', height: '15px'}" strokeWidth="8"  animationDuration=".5s"></p-progressSpinner>
                                <span *ngIf="!Spinner" class="glyphicon glyphicon-save"></span>{{buttonname}}
                            </button>
                            </div>
                        </div>
                    </div>
                </p-tabPanel>
            </p-tabView>
        </div>
      </div>
    </div>
  </div>
</div>
